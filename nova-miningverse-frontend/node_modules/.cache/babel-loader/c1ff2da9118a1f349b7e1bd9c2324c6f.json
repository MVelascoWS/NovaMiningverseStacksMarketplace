{"ast":null,"code":"/*\n * This module is intended to be executed both on client side and server side.\n * No error should be thrown. (soft error handling)\n */\n(function () {\n  var root = {}; // Dependencies --------------------------------------------------------------\n\n  root.async = typeof require === 'function' ? require('async') : window.async;\n\n  if (typeof root.async !== 'object') {\n    throw new Error('Module async is required (https://github.com/caolan/async)');\n  }\n\n  var async = root.async;\n\n  function _extend(origin, add) {\n    if (!add || typeof add !== 'object') {\n      return origin;\n    }\n\n    var keys = Object.keys(add);\n    var i = keys.length;\n\n    while (i--) {\n      origin[keys[i]] = add[keys[i]];\n    }\n\n    return origin;\n  }\n\n  function _merge() {\n    var ret = {};\n    var args = Array.prototype.slice.call(arguments);\n    var keys = null;\n    var i = null;\n    args.forEach(function (arg) {\n      if (arg && arg.constructor === Object) {\n        keys = Object.keys(arg);\n        i = keys.length;\n\n        while (i--) {\n          ret[keys[i]] = arg[keys[i]];\n        }\n      }\n    });\n    return ret;\n  } // Customisable class (Base class) -------------------------------------------\n  // Use with operation \"new\" to extend Validation and Sanitization themselves,\n  // not their prototype. In other words, constructor shall be call to extend\n  // those functions, instead of being in their constructor, like this:\n  //\t\t_extend(Validation, new Customisable);\n\n\n  function Customisable() {\n    this.custom = {};\n\n    this.extend = function (custom) {\n      return _extend(this.custom, custom);\n    };\n\n    this.reset = function () {\n      this.custom = {};\n    };\n\n    this.remove = function (fields) {\n      if (!_typeIs.array(fields)) {\n        fields = [fields];\n      }\n\n      fields.forEach(function (field) {\n        delete this.custom[field];\n      }, this);\n    };\n  } // Inspection class (Base class) ---------------------------------------------\n  // Use to extend Validation and Sanitization prototypes. Inspection\n  // constructor shall be called in derived class constructor.\n\n\n  function Inspection(schema, custom) {\n    var _stack = ['@'];\n    this._schema = schema;\n    this._custom = {};\n\n    if (custom != null) {\n      for (var key in custom) {\n        if (Object.prototype.hasOwnProperty.call(custom, key)) {\n          this._custom['$' + key] = custom[key];\n        }\n      }\n    }\n\n    this._getDepth = function () {\n      return _stack.length;\n    };\n\n    this._dumpStack = function () {\n      return _stack.map(function (i) {\n        return i.replace(/^\\[/g, '\\u001b\\u001c\\u001d\\u001e');\n      }).join('.').replace(/\\.\\u001b\\u001c\\u001d\\u001e/g, '[');\n    };\n\n    this._deeperObject = function (name) {\n      _stack.push(/^[a-z$_][a-z0-9$_]*$/i.test(name) ? name : '[\"' + name + '\"]');\n\n      return this;\n    };\n\n    this._deeperArray = function (i) {\n      _stack.push('[' + i + ']');\n\n      return this;\n    };\n\n    this._back = function () {\n      _stack.pop();\n\n      return this;\n    };\n  } // Simple types --------------------------------------------------------------\n  // If the property is not defined or is not in this list:\n\n\n  var _typeIs = {\n    \"function\": function (element) {\n      return typeof element === 'function';\n    },\n    \"string\": function (element) {\n      return typeof element === 'string';\n    },\n    \"number\": function (element) {\n      return typeof element === 'number' && !isNaN(element);\n    },\n    \"integer\": function (element) {\n      return typeof element === 'number' && element % 1 === 0;\n    },\n    \"NaN\": function (element) {\n      return typeof element === 'number' && isNaN(element);\n    },\n    \"boolean\": function (element) {\n      return typeof element === 'boolean';\n    },\n    \"null\": function (element) {\n      return element === null;\n    },\n    \"date\": function (element) {\n      return element != null && element instanceof Date;\n    },\n    \"object\": function (element) {\n      return typeof element === 'object' && element.constructor !== Array && element != null;\n    },\n    \"array\": function (element) {\n      return element != null && element.constructor === Array;\n    },\n    \"any\": function () {\n      return true;\n    }\n  };\n\n  function _simpleType(type, candidate) {\n    if (typeof type == 'function') {\n      return candidate instanceof type;\n    }\n\n    type = type in _typeIs ? type : 'any';\n    return _typeIs[type](candidate);\n  }\n\n  function _realType(candidate) {\n    for (var i in _typeIs) {\n      if (_simpleType(i, candidate)) {\n        if (i !== 'any' && (i !== 'object' || candidate.constructor === Object)) {\n          return i;\n        }\n\n        return 'an instance of ' + candidate.constructor.name;\n      }\n    }\n  }\n\n  function getIndexes(a, value) {\n    var indexes = [];\n    var i = a.indexOf(value);\n\n    while (i !== -1) {\n      indexes.push(i);\n      i = a.indexOf(value, i + 1);\n    }\n\n    return indexes;\n  } // Available formats ---------------------------------------------------------\n\n\n  var _formats = {\n    'void': /^$/,\n    'url': /^(https?|ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)?(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i,\n    'date-time': /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?(Z?|(-|\\+)\\d{2}:\\d{2})$/,\n    'date': /^\\d{4}-\\d{2}-\\d{2}$/,\n    'coolDateTime': /^\\d{4}(-|\\/)\\d{2}(-|\\/)\\d{2}(T| )\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$/,\n    'time': /^\\d{2}\\:\\d{2}\\:\\d{2}$/,\n    'color': /^#([0-9a-f])+$/i,\n    // 2021-03-13 - Email regex was replaced with result of running email-safe-regex\n    // latest version as of that day in order so fix GHSL-2020-35.\n    // const emailRegexSafe = require('email-regex-safe');\n    // const regexString = emailRegexSafe({\n    //   exact: true,\n    //   returnString: true,\n    // });\n    // <using debugger to inspect state of regexString after previous statement>\n    //\n    // Note that this regex is pretty flexible, but it's a bit stricter than\n    // what we had before. It requires the local part of the email address to\n    // be at least two characters. Was able to find some justification for\n    // this at https://stackoverflow.com/a/15783334/5051165. Test suite\n    // was corrected accordingly.\n    'email': new RegExp(`(?:[^\\\\W_](?:[\\\\w\\\\.\\\\+]+)@(?:localhost|(?:25[0-5]|2[0-4]\\\\d|1\\\\d\\\\d|[1-9]\\\\d|\\\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\\\d|1\\\\d\\\\d|[1-9]\\\\d|\\\\d)){3}|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9][-_]*)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:northwesternmutual|travelersinsurance|vermögensberatung|vermögensberater|americanexpress|kerryproperties|sandvikcoromant|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|construction|lplfinancial|scholarships|versicherung|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|موريتانيا|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|السعودية|yokohama|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|католик|الجزائر|العليان|اتصالات|پاکستان|البحرين|كاثوليك|இந்தியா|yamaxun|youtube|zuerich|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|москва|онлайн|ファッション|भारतम्|ارامكو|امارات|الاردن|المغرب|ابوظبي|مليسيا|இலங்கை|فلسطين|yachts|yandex|zappos|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|ישראל|বাংলা|భారత్|भारोत|संगठन|ایران|بازار|بھارت|سودان|همراه|سورية|ഭാരതം|嘉里大酒店|yahoo|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|ಭಾರತ|ଭାରତ|大众汽车|ভাৰত|ভারত|موقع|香格里拉|сайт|アマゾン|дети|ポイント|ලංකා|電訊盈科|クラウド|ભારત|भारत|عمان|بارت|ڀارت|عراق|شبكة|بيتك|组织机构|تونس|グーグル|ਭਾਰਤ|yoga|zara|zero|zone|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|कॉम|セール|คอม|我爱你|қаз|срб|бел|קום|淡马锡|орг|नेट|ストア|мкд|كوم|中文网|ком|укр|亚马逊|诺基亚|飞利浦|мон|عرب|ไทย|рус|ລາວ|みんな|天主教|مصر|قطر|հայ|新加坡|xxx|xyz|you|yun|zip|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|佛山|慈善|集团|在线|한국|点看|八卦|公益|公司|网站|移动|联通|бг|时尚|微博|삼성|商标|商店|商城|ею|新闻|家電|中信|中国|中國|娱乐|谷歌|购物|通販|网店|餐厅|网络|香港|食品|台湾|台灣|手机|澳門|닷컴|政府|გე|机构|健康|招聘|рф|大拿|ευ|ελ|世界|書籍|网址|닷넷|コム|游戏|企业|信息|嘉里|广东|政务|ye|yt|za|zm|zw))))`),\n    'numeric': /^[0-9]+$/,\n    'integer': /^\\-?[0-9]+$/,\n    'decimal': /^\\-?[0-9]*\\.?[0-9]+$/,\n    'alpha': /^[a-z]+$/i,\n    'alphaNumeric': /^[a-z0-9]+$/i,\n    'alphaDash': /^[a-z0-9_-]+$/i,\n    'javascript': /^[a-z_\\$][a-z0-9_\\$]*$/i,\n    'upperString': /^[A-Z ]*$/,\n    'lowerString': /^[a-z ]*$/,\n    'v4uuid': /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}$/i\n  }; // Validation ------------------------------------------------------------------\n\n  var _validationAttribut = {\n    optional: function (schema, candidate) {\n      var opt = typeof schema.optional === 'boolean' ? schema.optional : schema.optional === 'true'; // Default is false\n\n      if (opt === true) {\n        return;\n      }\n\n      if (typeof candidate === 'undefined') {\n        this.report('is missing and not optional', null, 'optional');\n      }\n    },\n    type: function (schema, candidate) {\n      // return because optional function already handle this case\n      if (typeof candidate === 'undefined' || typeof schema.type !== 'string' && !(schema.type instanceof Array) && typeof schema.type !== 'function') {\n        return;\n      }\n\n      var types = _typeIs.array(schema.type) ? schema.type : [schema.type];\n      var typeIsValid = types.some(function (type) {\n        return _simpleType(type, candidate);\n      });\n\n      if (!typeIsValid) {\n        types = types.map(function (t) {\n          return typeof t === 'function' ? 'an instance of ' + t.name : t;\n        });\n        this.report('must be ' + types.join(' or ') + ', but is ' + _realType(candidate), null, 'type');\n      }\n    },\n    uniqueness: function (schema, candidate) {\n      if (typeof schema.uniqueness === 'string') {\n        schema.uniqueness = schema.uniqueness === 'true';\n      }\n\n      if (typeof schema.uniqueness !== 'boolean' || schema.uniqueness === false || !_typeIs.array(candidate) && typeof candidate !== 'string') {\n        return;\n      }\n\n      var reported = [];\n\n      for (var i = 0; i < candidate.length; i++) {\n        if (reported.indexOf(candidate[i]) >= 0) {\n          continue;\n        }\n\n        var indexes = getIndexes(candidate, candidate[i]);\n\n        if (indexes.length > 1) {\n          reported.push(candidate[i]);\n          this.report('has value [' + candidate[i] + '] more than once at indexes [' + indexes.join(', ') + ']', null, 'uniqueness');\n        }\n      }\n    },\n    pattern: function (schema, candidate) {\n      var self = this;\n      var regexs = schema.pattern;\n\n      if (typeof candidate !== 'string') {\n        return;\n      }\n\n      var matches = false;\n\n      if (!_typeIs.array(regexs)) {\n        regexs = [regexs];\n      }\n\n      regexs.forEach(function (regex) {\n        if (typeof regex === 'string' && regex in _formats) {\n          regex = _formats[regex];\n        }\n\n        if (regex instanceof RegExp) {\n          if (regex.test(candidate)) {\n            matches = true;\n          }\n        }\n      });\n\n      if (!matches) {\n        self.report('must match [' + regexs.join(' or ') + '], but is equal to \"' + candidate + '\"', null, 'pattern');\n      }\n    },\n    validDate: function (schema, candidate) {\n      if (String(schema.validDate) === 'true' && candidate instanceof Date && isNaN(candidate.getTime())) {\n        this.report('must be a valid date', null, 'validDate');\n      }\n    },\n    minLength: function (schema, candidate) {\n      if (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n        return;\n      }\n\n      var minLength = Number(schema.minLength);\n\n      if (isNaN(minLength)) {\n        return;\n      }\n\n      if (candidate.length < minLength) {\n        this.report('must be longer than ' + minLength + ' elements, but it has ' + candidate.length, null, 'minLength');\n      }\n    },\n    maxLength: function (schema, candidate) {\n      if (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n        return;\n      }\n\n      var maxLength = Number(schema.maxLength);\n\n      if (isNaN(maxLength)) {\n        return;\n      }\n\n      if (candidate.length > maxLength) {\n        this.report('must be shorter than ' + maxLength + ' elements, but it has ' + candidate.length, null, 'maxLength');\n      }\n    },\n    exactLength: function (schema, candidate) {\n      if (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n        return;\n      }\n\n      var exactLength = Number(schema.exactLength);\n\n      if (isNaN(exactLength)) {\n        return;\n      }\n\n      if (candidate.length !== exactLength) {\n        this.report('must have exactly ' + exactLength + ' elements, but it have ' + candidate.length, null, 'exactLength');\n      }\n    },\n    lt: function (schema, candidate) {\n      var limit = Number(schema.lt);\n\n      if (typeof candidate !== 'number' || isNaN(limit)) {\n        return;\n      }\n\n      if (candidate >= limit) {\n        this.report('must be less than ' + limit + ', but is equal to \"' + candidate + '\"', null, 'lt');\n      }\n    },\n    lte: function (schema, candidate) {\n      var limit = Number(schema.lte);\n\n      if (typeof candidate !== 'number' || isNaN(limit)) {\n        return;\n      }\n\n      if (candidate > limit) {\n        this.report('must be less than or equal to ' + limit + ', but is equal to \"' + candidate + '\"', null, 'lte');\n      }\n    },\n    gt: function (schema, candidate) {\n      var limit = Number(schema.gt);\n\n      if (typeof candidate !== 'number' || isNaN(limit)) {\n        return;\n      }\n\n      if (candidate <= limit) {\n        this.report('must be greater than ' + limit + ', but is equal to \"' + candidate + '\"', null, 'gt');\n      }\n    },\n    gte: function (schema, candidate) {\n      var limit = Number(schema.gte);\n\n      if (typeof candidate !== 'number' || isNaN(limit)) {\n        return;\n      }\n\n      if (candidate < limit) {\n        this.report('must be greater than or equal to ' + limit + ', but is equal to \"' + candidate + '\"', null, 'gte');\n      }\n    },\n    eq: function (schema, candidate) {\n      if (typeof candidate !== 'number' && typeof candidate !== 'string' && typeof candidate !== 'boolean') {\n        return;\n      }\n\n      var limit = schema.eq;\n\n      if (typeof limit !== 'number' && typeof limit !== 'string' && typeof limit !== 'boolean' && !_typeIs.array(limit)) {\n        return;\n      }\n\n      if (_typeIs.array(limit)) {\n        for (var i = 0; i < limit.length; i++) {\n          if (candidate === limit[i]) {\n            return;\n          }\n        }\n\n        this.report('must be equal to [' + limit.map(function (l) {\n          return '\"' + l + '\"';\n        }).join(' or ') + '], but is equal to \"' + candidate + '\"', null, 'eq');\n      } else {\n        if (candidate !== limit) {\n          this.report('must be equal to \"' + limit + '\", but is equal to \"' + candidate + '\"', null, 'eq');\n        }\n      }\n    },\n    ne: function (schema, candidate) {\n      if (typeof candidate !== 'number' && typeof candidate !== 'string') {\n        return;\n      }\n\n      var limit = schema.ne;\n\n      if (typeof limit !== 'number' && typeof limit !== 'string' && !_typeIs.array(limit)) {\n        return;\n      }\n\n      if (_typeIs.array(limit)) {\n        for (var i = 0; i < limit.length; i++) {\n          if (candidate === limit[i]) {\n            this.report('must not be equal to \"' + limit[i] + '\"', null, 'ne');\n            return;\n          }\n        }\n      } else {\n        if (candidate === limit) {\n          this.report('must not be equal to \"' + limit + '\"', null, 'ne');\n        }\n      }\n    },\n    someKeys: function (schema, candidat) {\n      var _keys = schema.someKeys;\n\n      if (!_typeIs.object(candidat)) {\n        return;\n      }\n\n      var valid = _keys.some(function (action) {\n        return action in candidat;\n      });\n\n      if (!valid) {\n        this.report('must have at least key ' + _keys.map(function (i) {\n          return '\"' + i + '\"';\n        }).join(' or '), null, 'someKeys');\n      }\n    },\n    strict: function (schema, candidate) {\n      if (typeof schema.strict === 'string') {\n        schema.strict = schema.strict === 'true';\n      }\n\n      if (schema.strict !== true || !_typeIs.object(candidate) || !_typeIs.object(schema.properties)) {\n        return;\n      }\n\n      var self = this;\n\n      if (typeof schema.properties['*'] === 'undefined') {\n        var intruder = Object.keys(candidate).filter(function (key) {\n          return typeof schema.properties[key] === 'undefined';\n        });\n\n        if (intruder.length > 0) {\n          var msg = 'should not contains ' + (intruder.length > 1 ? 'properties' : 'property') + ' [' + intruder.map(function (i) {\n            return '\"' + i + '\"';\n          }).join(', ') + ']';\n          self.report(msg, null, 'strict');\n        }\n      }\n    },\n    exec: function (schema, candidate, callback) {\n      var self = this;\n\n      if (typeof callback === 'function') {\n        return this.asyncExec(schema, candidate, callback);\n      }\n\n      (_typeIs.array(schema.exec) ? schema.exec : [schema.exec]).forEach(function (exec) {\n        if (typeof exec === 'function') {\n          exec.call(self, schema, candidate);\n        }\n      });\n    },\n    properties: function (schema, candidate, callback) {\n      if (typeof callback === 'function') {\n        return this.asyncProperties(schema, candidate, callback);\n      }\n\n      if (!(schema.properties instanceof Object) || !(candidate instanceof Object)) {\n        return;\n      }\n\n      var properties = schema.properties,\n          i;\n\n      if (properties['*'] != null) {\n        for (i in candidate) {\n          if (i in properties) {\n            continue;\n          }\n\n          this._deeperObject(i);\n\n          this._validate(properties['*'], candidate[i]);\n\n          this._back();\n        }\n      }\n\n      for (i in properties) {\n        if (i === '*') {\n          continue;\n        }\n\n        this._deeperObject(i);\n\n        this._validate(properties[i], candidate[i]);\n\n        this._back();\n      }\n    },\n    items: function (schema, candidate, callback) {\n      if (typeof callback === 'function') {\n        return this.asyncItems(schema, candidate, callback);\n      }\n\n      if (!(schema.items instanceof Object) || !(candidate instanceof Object)) {\n        return;\n      }\n\n      var items = schema.items;\n      var i, l; // If provided schema is an array\n      // then call validate for each case\n      // else it is an Object\n      // then call validate for each key\n\n      if (_typeIs.array(items) && _typeIs.array(candidate)) {\n        for (i = 0, l = items.length; i < l; i++) {\n          this._deeperArray(i);\n\n          this._validate(items[i], candidate[i]);\n\n          this._back();\n        }\n      } else {\n        for (var key in candidate) {\n          if (Object.prototype.hasOwnProperty.call(candidate, key)) {\n            this._deeperArray(key);\n\n            this._validate(items, candidate[key]);\n\n            this._back();\n          }\n        }\n      }\n    }\n  };\n  var _asyncValidationAttribut = {\n    asyncExec: function (schema, candidate, callback) {\n      var self = this;\n      async.eachSeries(_typeIs.array(schema.exec) ? schema.exec : [schema.exec], function (exec, done) {\n        if (typeof exec === 'function') {\n          if (exec.length > 2) {\n            return exec.call(self, schema, candidate, done);\n          }\n\n          exec.call(self, schema, candidate);\n        }\n\n        async.nextTick(done);\n      }, callback);\n    },\n    asyncProperties: function (schema, candidate, callback) {\n      if (!(schema.properties instanceof Object) || !_typeIs.object(candidate)) {\n        return callback();\n      }\n\n      var self = this;\n      var properties = schema.properties;\n      async.series([function (next) {\n        if (properties['*'] == null) {\n          return next();\n        }\n\n        async.eachSeries(Object.keys(candidate), function (i, done) {\n          if (i in properties) {\n            return async.nextTick(done);\n          }\n\n          self._deeperObject(i);\n\n          self._asyncValidate(properties['*'], candidate[i], function (err) {\n            self._back();\n\n            done(err);\n          });\n        }, next);\n      }, function (next) {\n        async.eachSeries(Object.keys(properties), function (i, done) {\n          if (i === '*') {\n            return async.nextTick(done);\n          }\n\n          self._deeperObject(i);\n\n          self._asyncValidate(properties[i], candidate[i], function (err) {\n            self._back();\n\n            done(err);\n          });\n        }, next);\n      }], callback);\n    },\n    asyncItems: function (schema, candidate, callback) {\n      if (!(schema.items instanceof Object) || !(candidate instanceof Object)) {\n        return callback();\n      }\n\n      var self = this;\n      var items = schema.items;\n      var i, l;\n\n      if (_typeIs.array(items) && _typeIs.array(candidate)) {\n        async.timesSeries(items.length, function (i, done) {\n          self._deeperArray(i);\n\n          self._asyncValidate(items[i], candidate[i], function (err, res) {\n            self._back();\n\n            done(err, res);\n          });\n\n          self._back();\n        }, callback);\n      } else {\n        async.eachSeries(Object.keys(candidate), function (key, done) {\n          self._deeperArray(key);\n\n          self._asyncValidate(items, candidate[key], function (err, res) {\n            self._back();\n\n            done(err, res);\n          });\n        }, callback);\n      }\n    }\n  }; // Validation Class ----------------------------------------------------------\n  // inherits from Inspection class (actually we just call Inspection\n  // constructor with the new context, because its prototype is empty\n\n  function Validation(schema, custom) {\n    Inspection.prototype.constructor.call(this, schema, _merge(Validation.custom, custom));\n    var _error = [];\n    this._basicFields = Object.keys(_validationAttribut);\n    this._customFields = Object.keys(this._custom);\n    this.origin = null;\n\n    this.report = function (message, code, reason) {\n      var newErr = {\n        code: code || this.userCode || null,\n        reason: reason || 'unknown',\n        message: this.userError || message || 'is invalid',\n        property: this.userAlias ? this.userAlias + ' (' + this._dumpStack() + ')' : this._dumpStack()\n      };\n\n      _error.push(newErr);\n\n      return this;\n    };\n\n    this.result = function () {\n      return {\n        error: _error,\n        valid: _error.length === 0,\n        format: function () {\n          if (this.valid === true) {\n            return 'Candidate is valid';\n          }\n\n          return this.error.map(function (i) {\n            return 'Property ' + i.property + ': ' + i.message;\n          }).join('\\n');\n        }\n      };\n    };\n  }\n\n  _extend(Validation.prototype, _validationAttribut);\n\n  _extend(Validation.prototype, _asyncValidationAttribut);\n\n  _extend(Validation, new Customisable());\n\n  Validation.prototype.validate = function (candidate, callback) {\n    this.origin = candidate;\n\n    if (typeof callback === 'function') {\n      var self = this;\n      return async.nextTick(function () {\n        self._asyncValidate(self._schema, candidate, function (err) {\n          self.origin = null;\n          callback(err, self.result());\n        });\n      });\n    }\n\n    return this._validate(this._schema, candidate).result();\n  };\n\n  Validation.prototype._validate = function (schema, candidate, callback) {\n    this.userCode = schema.code || null;\n    this.userError = schema.error || null;\n    this.userAlias = schema.alias || null;\n\n    this._basicFields.forEach(function (i) {\n      if ((i in schema || i === 'optional') && typeof this[i] === 'function') {\n        this[i](schema, candidate);\n      }\n    }, this);\n\n    this._customFields.forEach(function (i) {\n      if (i in schema && typeof this._custom[i] === 'function') {\n        this._custom[i].call(this, schema, candidate);\n      }\n    }, this);\n\n    return this;\n  };\n\n  Validation.prototype._asyncValidate = function (schema, candidate, callback) {\n    var self = this;\n    this.userCode = schema.code || null;\n    this.userError = schema.error || null;\n    this.userAlias = schema.alias || null;\n    async.series([function (next) {\n      async.eachSeries(Object.keys(_validationAttribut), function (i, done) {\n        async.nextTick(function () {\n          if ((i in schema || i === 'optional') && typeof self[i] === 'function') {\n            if (self[i].length > 2) {\n              return self[i](schema, candidate, done);\n            }\n\n            self[i](schema, candidate);\n          }\n\n          done();\n        });\n      }, next);\n    }, function (next) {\n      async.eachSeries(Object.keys(self._custom), function (i, done) {\n        async.nextTick(function () {\n          if (i in schema && typeof self._custom[i] === 'function') {\n            if (self._custom[i].length > 2) {\n              return self._custom[i].call(self, schema, candidate, done);\n            }\n\n            self._custom[i].call(self, schema, candidate);\n          }\n\n          done();\n        });\n      }, next);\n    }], callback);\n  }; // Sanitization ----------------------------------------------------------------\n  // functions called by _sanitization.type method.\n\n\n  var _forceType = {\n    number: function (post, schema) {\n      var n;\n\n      if (typeof post === 'number') {\n        return post;\n      } else if (post === '') {\n        if (typeof schema.def !== 'undefined') return schema.def;\n        return null;\n      } else if (typeof post === 'string') {\n        n = parseFloat(post.replace(/,/g, '.').replace(/ /g, ''));\n\n        if (typeof n === 'number') {\n          return n;\n        }\n      } else if (post instanceof Date) {\n        return +post;\n      }\n\n      return null;\n    },\n    integer: function (post, schema) {\n      var n;\n\n      if (typeof post === 'number' && post % 1 === 0) {\n        return post;\n      } else if (post === '') {\n        if (typeof schema.def !== 'undefined') return schema.def;\n        return null;\n      } else if (typeof post === 'string') {\n        n = parseInt(post.replace(/ /g, ''), 10);\n\n        if (typeof n === 'number') {\n          return n;\n        }\n      } else if (typeof post === 'number') {\n        return parseInt(post, 10);\n      } else if (typeof post === 'boolean') {\n        if (post) {\n          return 1;\n        }\n\n        return 0;\n      } else if (post instanceof Date) {\n        return +post;\n      }\n\n      return null;\n    },\n    string: function (post, schema) {\n      if (typeof post === 'boolean' || typeof post === 'number' || post instanceof Date) {\n        return post.toString();\n      } else if (_typeIs.array(post)) {\n        // If user authorize array and strings...\n        if (schema.items || schema.properties) return post;\n        return post.join(String(schema.joinWith || ','));\n      } else if (post instanceof Object) {\n        // If user authorize objects ans strings...\n        if (schema.items || schema.properties) return post;\n        return JSON.stringify(post);\n      } else if (typeof post === 'string' && post.length) {\n        return post;\n      }\n\n      return null;\n    },\n    date: function (post, schema) {\n      if (post instanceof Date) {\n        return post;\n      } else {\n        var d = new Date(post);\n\n        if (!isNaN(d.getTime())) {\n          // if valid date\n          return d;\n        }\n      }\n\n      return null;\n    },\n    boolean: function (post, schema) {\n      if (typeof post === 'undefined') return null;\n      if (typeof post === 'string' && post.toLowerCase() === 'false') return false;\n      return !!post;\n    },\n    object: function (post, schema) {\n      if (typeof post !== 'string' || _typeIs.object(post)) {\n        return post;\n      }\n\n      try {\n        return JSON.parse(post);\n      } catch (e) {\n        return null;\n      }\n    },\n    array: function (post, schema) {\n      if (_typeIs.array(post)) return post;\n      if (typeof post === 'undefined') return null;\n\n      if (typeof post === 'string') {\n        if (post.substring(0, 1) === '[' && post.slice(-1) === ']') {\n          try {\n            return JSON.parse(post);\n          } catch (e) {\n            return null;\n          }\n        }\n\n        return post.split(String(schema.splitWith || ','));\n      }\n\n      if (!_typeIs.array(post)) return [post];\n      return null;\n    }\n  };\n  var _applyRules = {\n    upper: function (post) {\n      return post.toUpperCase();\n    },\n    lower: function (post) {\n      return post.toLowerCase();\n    },\n    title: function (post) {\n      // Fix by seb (replace \\w\\S* by \\S* => exemple : coucou ça va)\n      return post.replace(/\\S*/g, function (txt) {\n        return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n      });\n    },\n    capitalize: function (post) {\n      return post.charAt(0).toUpperCase() + post.substr(1).toLowerCase();\n    },\n    ucfirst: function (post) {\n      return post.charAt(0).toUpperCase() + post.substr(1);\n    },\n    trim: function (post) {\n      return post.trim();\n    }\n  }; // Every function return the future value of each property. Therefore you\n  // have to return post even if you do not change its value\n\n  var _sanitizationAttribut = {\n    strict: function (schema, post) {\n      if (typeof schema.strict === 'string') {\n        schema.strict = schema.strict === 'true';\n      }\n\n      if (schema.strict !== true) return post;\n      if (!_typeIs.object(schema.properties)) return post;\n      if (!_typeIs.object(post)) return post;\n      var that = this;\n      Object.keys(post).forEach(function (key) {\n        if (!(key in schema.properties)) {\n          delete post[key];\n        }\n      });\n      return post;\n    },\n    optional: function (schema, post) {\n      var opt = typeof schema.optional === 'boolean' ? schema.optional : schema.optional !== 'false'; // Default: true\n\n      if (opt === true) {\n        return post;\n      }\n\n      if (typeof post !== 'undefined') {\n        return post;\n      }\n\n      this.report();\n\n      if (schema.def === Date) {\n        return new Date();\n      }\n\n      return schema.def;\n    },\n    type: function (schema, post) {\n      // if (_typeIs['object'](post) || _typeIs.array(post)) {\n      // \treturn post;\n      // }\n      if (typeof schema.type !== 'string' || typeof _forceType[schema.type] !== 'function') {\n        return post;\n      }\n\n      var n;\n      var opt = typeof schema.optional === 'boolean' ? schema.optional : true;\n\n      if (typeof _forceType[schema.type] === 'function') {\n        n = _forceType[schema.type](post, schema);\n\n        if (n === null && !opt || !n && isNaN(n) || n === null && schema.type === 'string') {\n          n = schema.def;\n        }\n      } else if (!opt) {\n        n = schema.def;\n      }\n\n      if ((n != null || typeof schema.def !== 'undefined' && schema.def === n) && n !== post) {\n        this.report();\n        return n;\n      }\n\n      return post;\n    },\n    rules: function (schema, post) {\n      var rules = schema.rules;\n\n      if (typeof post !== 'string' || typeof rules !== 'string' && !_typeIs.array(rules)) {\n        return post;\n      }\n\n      var modified = false;\n      (_typeIs.array(rules) ? rules : [rules]).forEach(function (rule) {\n        if (typeof _applyRules[rule] === 'function') {\n          post = _applyRules[rule](post);\n          modified = true;\n        }\n      });\n\n      if (modified) {\n        this.report();\n      }\n\n      return post;\n    },\n    min: function (schema, post) {\n      var postTest = Number(post);\n\n      if (isNaN(postTest)) {\n        return post;\n      }\n\n      var min = Number(schema.min);\n\n      if (isNaN(min)) {\n        return post;\n      }\n\n      if (postTest < min) {\n        this.report();\n        return min;\n      }\n\n      return post;\n    },\n    max: function (schema, post) {\n      var postTest = Number(post);\n\n      if (isNaN(postTest)) {\n        return post;\n      }\n\n      var max = Number(schema.max);\n\n      if (isNaN(max)) {\n        return post;\n      }\n\n      if (postTest > max) {\n        this.report();\n        return max;\n      }\n\n      return post;\n    },\n    minLength: function (schema, post) {\n      var limit = Number(schema.minLength);\n\n      if (typeof post !== 'string' || isNaN(limit) || limit < 0) {\n        return post;\n      }\n\n      var str = '';\n      var gap = limit - post.length;\n\n      if (gap > 0) {\n        for (var i = 0; i < gap; i++) {\n          str += '-';\n        }\n\n        this.report();\n        return post + str;\n      }\n\n      return post;\n    },\n    maxLength: function (schema, post) {\n      var limit = Number(schema.maxLength);\n\n      if (typeof post !== 'string' || isNaN(limit) || limit < 0) {\n        return post;\n      }\n\n      if (post.length > limit) {\n        this.report();\n        return post.slice(0, limit);\n      }\n\n      return post;\n    },\n    properties: function (schema, post, callback) {\n      if (typeof callback === 'function') {\n        return this.asyncProperties(schema, post, callback);\n      }\n\n      if (!post || typeof post !== 'object') {\n        return post;\n      }\n\n      var properties = schema.properties;\n      var tmp;\n      var i;\n\n      if (typeof properties['*'] !== 'undefined') {\n        for (i in post) {\n          if (i in properties) {\n            continue;\n          }\n\n          this._deeperObject(i);\n\n          tmp = this._sanitize(schema.properties['*'], post[i]);\n\n          if (typeof tmp !== 'undefined') {\n            post[i] = tmp;\n          }\n\n          this._back();\n        }\n      }\n\n      for (i in schema.properties) {\n        if (i !== '*') {\n          this._deeperObject(i);\n\n          tmp = this._sanitize(schema.properties[i], post[i]);\n\n          if (typeof tmp !== 'undefined') {\n            post[i] = tmp;\n          }\n\n          this._back();\n        }\n      }\n\n      return post;\n    },\n    items: function (schema, post, callback) {\n      if (typeof callback === 'function') {\n        return this.asyncItems(schema, post, callback);\n      }\n\n      if (!(schema.items instanceof Object) || !(post instanceof Object)) {\n        return post;\n      }\n\n      var i;\n\n      if (_typeIs.array(schema.items) && _typeIs.array(post)) {\n        var minLength = schema.items.length < post.length ? schema.items.length : post.length;\n\n        for (i = 0; i < minLength; i++) {\n          this._deeperArray(i);\n\n          post[i] = this._sanitize(schema.items[i], post[i]);\n\n          this._back();\n        }\n      } else {\n        for (i in post) {\n          if (Object.prototype.hasOwnProperty.call(post, i)) {\n            this._deeperArray(i);\n\n            post[i] = this._sanitize(schema.items, post[i]);\n\n            this._back();\n          }\n        }\n      }\n\n      return post;\n    },\n    exec: function (schema, post, callback) {\n      if (typeof callback === 'function') {\n        return this.asyncExec(schema, post, callback);\n      }\n\n      var execs = _typeIs.array(schema.exec) ? schema.exec : [schema.exec];\n      execs.forEach(function (exec) {\n        if (typeof exec === 'function') {\n          post = exec.call(this, schema, post);\n        }\n      }, this);\n      return post;\n    }\n  };\n  var _asyncSanitizationAttribut = {\n    asyncExec: function (schema, post, callback) {\n      var self = this;\n      var execs = _typeIs.array(schema.exec) ? schema.exec : [schema.exec];\n      async.eachSeries(execs, function (exec, done) {\n        if (typeof exec === 'function') {\n          if (exec.length > 2) {\n            return exec.call(self, schema, post, function (err, res) {\n              if (err) {\n                return done(err);\n              }\n\n              post = res;\n              done();\n            });\n          }\n\n          post = exec.call(self, schema, post);\n        }\n\n        done();\n      }, function (err) {\n        callback(err, post);\n      });\n    },\n    asyncProperties: function (schema, post, callback) {\n      if (!post || typeof post !== 'object') {\n        return callback(null, post);\n      }\n\n      var self = this;\n      var properties = schema.properties;\n      async.series([function (next) {\n        if (properties['*'] == null) {\n          return next();\n        }\n\n        var globing = properties['*'];\n        async.eachSeries(Object.keys(post), function (i, next) {\n          if (i in properties) {\n            return next();\n          }\n\n          self._deeperObject(i);\n\n          self._asyncSanitize(globing, post[i], function (err, res) {\n            if (err) {\n              /* Error can safely be ignored here */\n            }\n\n            if (typeof res !== 'undefined') {\n              post[i] = res;\n            }\n\n            self._back();\n\n            next();\n          });\n        }, next);\n      }, function (next) {\n        async.eachSeries(Object.keys(properties), function (i, next) {\n          if (i === '*') {\n            return next();\n          }\n\n          self._deeperObject(i);\n\n          self._asyncSanitize(properties[i], post[i], function (err, res) {\n            if (err) {\n              return next(err);\n            }\n\n            if (typeof res !== 'undefined') {\n              post[i] = res;\n            }\n\n            self._back();\n\n            next();\n          });\n        }, next);\n      }], function (err) {\n        return callback(err, post);\n      });\n    },\n    asyncItems: function (schema, post, callback) {\n      if (!(schema.items instanceof Object) || !(post instanceof Object)) {\n        return callback(null, post);\n      }\n\n      var self = this;\n      var items = schema.items;\n\n      if (_typeIs.array(items) && _typeIs.array(post)) {\n        var minLength = items.length < post.length ? items.length : post.length;\n        async.timesSeries(minLength, function (i, next) {\n          self._deeperArray(i);\n\n          self._asyncSanitize(items[i], post[i], function (err, res) {\n            if (err) {\n              return next(err);\n            }\n\n            post[i] = res;\n\n            self._back();\n\n            next();\n          });\n        }, function (err) {\n          callback(err, post);\n        });\n      } else {\n        async.eachSeries(Object.keys(post), function (key, next) {\n          self._deeperArray(key);\n\n          self._asyncSanitize(items, post[key], function (err, res) {\n            if (err) {\n              return next();\n            }\n\n            post[key] = res;\n\n            self._back();\n\n            next();\n          });\n        }, function (err) {\n          callback(err, post);\n        });\n      }\n\n      return post;\n    }\n  }; // Sanitization Class --------------------------------------------------------\n  // inherits from Inspection class (actually we just call Inspection\n  // constructor with the new context, because its prototype is empty\n\n  function Sanitization(schema, custom) {\n    Inspection.prototype.constructor.call(this, schema, _merge(Sanitization.custom, custom));\n    var _reporting = [];\n    this._basicFields = Object.keys(_sanitizationAttribut);\n    this._customFields = Object.keys(this._custom);\n    this.origin = null;\n\n    this.report = function (message) {\n      var newNot = {\n        message: message || 'was sanitized',\n        property: this.userAlias ? this.userAlias + ' (' + this._dumpStack() + ')' : this._dumpStack()\n      };\n\n      if (!_reporting.some(function (e) {\n        return e.property === newNot.property;\n      })) {\n        _reporting.push(newNot);\n      }\n    };\n\n    this.result = function (data) {\n      return {\n        data: data,\n        reporting: _reporting,\n        format: function () {\n          return this.reporting.map(function (i) {\n            return 'Property ' + i.property + ' ' + i.message;\n          }).join('\\n');\n        }\n      };\n    };\n  }\n\n  _extend(Sanitization.prototype, _sanitizationAttribut);\n\n  _extend(Sanitization.prototype, _asyncSanitizationAttribut);\n\n  _extend(Sanitization, new Customisable());\n\n  Sanitization.prototype.sanitize = function (post, callback) {\n    this.origin = post;\n\n    if (typeof callback === 'function') {\n      var self = this;\n      return this._asyncSanitize(this._schema, post, function (err, data) {\n        self.origin = null;\n        callback(err, self.result(data));\n      });\n    }\n\n    var data = this._sanitize(this._schema, post);\n\n    this.origin = null;\n    return this.result(data);\n  };\n\n  Sanitization.prototype._sanitize = function (schema, post) {\n    this.userAlias = schema.alias || null;\n\n    this._basicFields.forEach(function (i) {\n      if ((i in schema || i === 'optional') && typeof this[i] === 'function') {\n        post = this[i](schema, post);\n      }\n    }, this);\n\n    this._customFields.forEach(function (i) {\n      if (i in schema && typeof this._custom[i] === 'function') {\n        post = this._custom[i].call(this, schema, post);\n      }\n    }, this);\n\n    return post;\n  };\n\n  Sanitization.prototype._asyncSanitize = function (schema, post, callback) {\n    var self = this;\n    this.userAlias = schema.alias || null;\n    async.waterfall([function (next) {\n      async.reduce(self._basicFields, post, function (value, i, next) {\n        async.nextTick(function () {\n          if ((i in schema || i === 'optional') && typeof self[i] === 'function') {\n            if (self[i].length > 2) {\n              return self[i](schema, value, next);\n            }\n\n            value = self[i](schema, value);\n          }\n\n          next(null, value);\n        });\n      }, next);\n    }, function (inter, next) {\n      async.reduce(self._customFields, inter, function (value, i, next) {\n        async.nextTick(function () {\n          if (i in schema && typeof self._custom[i] === 'function') {\n            if (self._custom[i].length > 2) {\n              return self._custom[i].call(self, schema, value, next);\n            }\n\n            value = self._custom[i].call(self, schema, value);\n          }\n\n          next(null, value);\n        });\n      }, next);\n    }], callback);\n  }; // ---------------------------------------------------------------------------\n\n\n  var INT_MIN = -2147483648;\n  var INT_MAX = 2147483647;\n  var _rand = {\n    int: function (min, max) {\n      return min + (0 | Math.random() * (max - min + 1));\n    },\n    float: function (min, max) {\n      return Math.random() * (max - min) + min;\n    },\n    bool: function () {\n      return Math.random() > 0.5;\n    },\n    char: function (min, max) {\n      return String.fromCharCode(this.int(min, max));\n    },\n    fromList: function (list) {\n      return list[this.int(0, list.length - 1)];\n    }\n  };\n  var _formatSample = {\n    'date-time': function () {\n      return new Date().toISOString();\n    },\n    'date': function () {\n      return new Date().toISOString().replace(/T.*$/, '');\n    },\n    'time': function () {\n      return new Date().toLocaleTimeString({}, {\n        hour12: false\n      });\n    },\n    'color': function (min, max) {\n      var s = '#';\n\n      if (min < 1) {\n        min = 1;\n      }\n\n      for (var i = 0, l = _rand.int(min, max); i < l; i++) {\n        s += _rand.fromList('0123456789abcdefABCDEF');\n      }\n\n      return s;\n    },\n    'numeric': function () {\n      return '' + _rand.int(0, INT_MAX);\n    },\n    'integer': function () {\n      if (_rand.bool() === true) {\n        return '-' + this.numeric();\n      }\n\n      return this.numeric();\n    },\n    'decimal': function () {\n      return this.integer() + '.' + this.numeric();\n    },\n    'alpha': function (min, max) {\n      var s = '';\n\n      if (min < 1) {\n        min = 1;\n      }\n\n      for (var i = 0, l = _rand.int(min, max); i < l; i++) {\n        s += _rand.fromList('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ');\n      }\n\n      return s;\n    },\n    'alphaNumeric': function (min, max) {\n      var s = '';\n\n      if (min < 1) {\n        min = 1;\n      }\n\n      for (var i = 0, l = _rand.int(min, max); i < l; i++) {\n        s += _rand.fromList('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');\n      }\n\n      return s;\n    },\n    'alphaDash': function (min, max) {\n      var s = '';\n\n      if (min < 1) {\n        min = 1;\n      }\n\n      for (var i = 0, l = _rand.int(min, max); i < l; i++) {\n        s += _rand.fromList('_-abcdefghijklmnopqrstuvwxyz_-ABCDEFGHIJKLMNOPQRSTUVWXYZ_-0123456789_-');\n      }\n\n      return s;\n    },\n    'javascript': function (min, max) {\n      var s = _rand.fromList('_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$');\n\n      for (var i = 0, l = _rand.int(min, max - 1); i < l; i++) {\n        s += _rand.fromList('_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$0123456789_$');\n      }\n\n      return s;\n    }\n  };\n\n  function _getLimits(schema) {\n    var min = INT_MIN;\n    var max = INT_MAX;\n\n    if (schema.gte != null) {\n      min = schema.gte;\n    } else if (schema.gt != null) {\n      min = schema.gt + 1;\n    }\n\n    if (schema.lte != null) {\n      max = schema.lte;\n    } else if (schema.lt != null) {\n      max = schema.lt - 1;\n    }\n\n    return {\n      min: min,\n      max: max\n    };\n  }\n\n  var _typeGenerator = {\n    string: function (schema) {\n      if (schema.eq != null) {\n        return schema.eq;\n      }\n\n      var s = '';\n      var minLength = schema.minLength != null ? schema.minLength : 0;\n      var maxLength = schema.maxLength != null ? schema.maxLength : 32;\n\n      if (typeof schema.pattern === 'string' && typeof _formatSample[schema.pattern] === 'function') {\n        return _formatSample[schema.pattern](minLength, maxLength);\n      }\n\n      var l = schema.exactLength != null ? schema.exactLength : _rand.int(minLength, maxLength);\n\n      for (var i = 0; i < l; i++) {\n        s += _rand.char(32, 126);\n      }\n\n      return s;\n    },\n    number: function (schema) {\n      if (schema.eq != null) {\n        return schema.eq;\n      }\n\n      var limit = _getLimits(schema);\n\n      var n = _rand.float(limit.min, limit.max);\n\n      if (schema.ne != null) {\n        var ne = _typeIs.array(schema.ne) ? schema.ne : [schema.ne];\n\n        while (ne.indexOf(n) !== -1) {\n          n = _rand.float(limit.min, limit.max);\n        }\n      }\n\n      return n;\n    },\n    integer: function (schema) {\n      if (schema.eq != null) {\n        return schema.eq;\n      }\n\n      var limit = _getLimits(schema);\n\n      var n = _rand.int(limit.min, limit.max);\n\n      if (schema.ne != null) {\n        var ne = _typeIs.array(schema.ne) ? schema.ne : [schema.ne];\n\n        while (ne.indexOf(n) !== -1) {\n          n = _rand.int(limit.min, limit.max);\n        }\n      }\n\n      return n;\n    },\n    boolean: function (schema) {\n      if (schema.eq != null) {\n        return schema.eq;\n      }\n\n      return _rand.bool();\n    },\n    \"null\": function (schema) {\n      return null;\n    },\n    date: function (schema) {\n      if (schema.eq != null) {\n        return schema.eq;\n      }\n\n      return new Date();\n    },\n    object: function (schema) {\n      var o = {};\n      var prop = schema.properties || {};\n\n      for (var key in prop) {\n        if (Object.prototype.hasOwnProperty.call(prop, key)) {\n          if (prop[key].optional === true && _rand.bool() === true) {\n            continue;\n          }\n\n          if (key !== '*') {\n            o[key] = this.generate(prop[key]);\n          } else {\n            var rk = '__random_key_';\n            var randomKey = rk + 0;\n\n            var n = _rand.int(1, 9);\n\n            for (var i = 1; i <= n; i++) {\n              if (!(randomKey in prop)) {\n                o[randomKey] = this.generate(prop[key]);\n              }\n\n              randomKey = rk + i;\n            }\n          }\n        }\n      }\n\n      return o;\n    },\n    array: function (schema) {\n      var self = this;\n      var items = schema.items || {};\n      var minLength = schema.minLength != null ? schema.minLength : 0;\n      var maxLength = schema.maxLength != null ? schema.maxLength : 16;\n      var type;\n      var candidate;\n      var size;\n      var i;\n\n      if (_typeIs.array(items)) {\n        size = items.length;\n\n        if (schema.exactLength != null) {\n          size = schema.exactLength;\n        } else if (size < minLength) {\n          size = minLength;\n        } else if (size > maxLength) {\n          size = maxLength;\n        }\n\n        candidate = new Array(size);\n        type = null;\n\n        for (i = 0; i < size; i++) {\n          type = items[i].type || 'any';\n\n          if (_typeIs.array(type)) {\n            type = type[_rand.int(0, type.length - 1)];\n          }\n\n          candidate[i] = self[type](items[i]);\n        }\n      } else {\n        size = schema.exactLength != null ? schema.exactLength : _rand.int(minLength, maxLength);\n        candidate = new Array(size);\n        type = items.type || 'any';\n\n        if (_typeIs.array(type)) {\n          type = type[_rand.int(0, type.length - 1)];\n        }\n\n        for (i = 0; i < size; i++) {\n          candidate[i] = self[type](items);\n        }\n      }\n\n      return candidate;\n    },\n    any: function (schema) {\n      var fields = Object.keys(_typeGenerator);\n\n      var i = fields[_rand.int(0, fields.length - 2)];\n\n      return this[i](schema);\n    }\n  }; // CandidateGenerator Class (Singleton) --------------------------------------\n\n  function CandidateGenerator() {// Maybe extends Inspection class too ?\n  }\n\n  _extend(CandidateGenerator.prototype, _typeGenerator);\n\n  var _instance = null;\n\n  CandidateGenerator.instance = function () {\n    if (!(_instance instanceof CandidateGenerator)) {\n      _instance = new CandidateGenerator();\n    }\n\n    return _instance;\n  };\n\n  CandidateGenerator.prototype.generate = function (schema) {\n    var type = schema.type || 'any';\n\n    if (_typeIs.array(type)) {\n      type = type[_rand.int(0, type.length - 1)];\n    }\n\n    return this[type](schema);\n  }; // Exports ---------------------------------------------------------------------\n\n\n  var SchemaInspector = {}; // if server-side (node.js) else client-side\n\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = SchemaInspector;\n  } else {\n    window.SchemaInspector = SchemaInspector;\n  }\n\n  SchemaInspector.newSanitization = function (schema, custom) {\n    return new Sanitization(schema, custom);\n  };\n\n  SchemaInspector.newValidation = function (schema, custom) {\n    return new Validation(schema, custom);\n  };\n\n  SchemaInspector.Validation = Validation;\n  SchemaInspector.Sanitization = Sanitization;\n\n  SchemaInspector.sanitize = function (schema, post, custom, callback) {\n    if (arguments.length === 3 && typeof custom === 'function') {\n      callback = custom;\n      custom = null;\n    }\n\n    return new Sanitization(schema, custom).sanitize(post, callback);\n  };\n\n  SchemaInspector.validate = function (schema, candidate, custom, callback) {\n    if (arguments.length === 3 && typeof custom === 'function') {\n      callback = custom;\n      custom = null;\n    }\n\n    return new Validation(schema, custom).validate(candidate, callback);\n  };\n\n  SchemaInspector.generate = function (schema, n) {\n    if (typeof n === 'number') {\n      var r = new Array(n);\n\n      for (var i = 0; i < n; i++) {\n        r[i] = CandidateGenerator.instance().generate(schema);\n      }\n\n      return r;\n    }\n\n    return CandidateGenerator.instance().generate(schema);\n  };\n})();","map":{"version":3,"names":["root","async","require","window","Error","_extend","origin","add","keys","Object","i","length","_merge","ret","args","Array","prototype","slice","call","arguments","forEach","arg","constructor","Customisable","custom","extend","reset","remove","fields","_typeIs","array","field","Inspection","schema","_stack","_schema","_custom","key","hasOwnProperty","_getDepth","_dumpStack","map","replace","join","_deeperObject","name","push","test","_deeperArray","_back","pop","element","isNaN","Date","_simpleType","type","candidate","_realType","getIndexes","a","value","indexes","indexOf","_formats","RegExp","_validationAttribut","optional","opt","report","types","typeIsValid","some","t","uniqueness","reported","pattern","self","regexs","matches","regex","validDate","String","getTime","minLength","Number","maxLength","exactLength","lt","limit","lte","gt","gte","eq","l","ne","someKeys","candidat","_keys","object","valid","action","strict","properties","intruder","filter","msg","exec","callback","asyncExec","asyncProperties","_validate","items","asyncItems","_asyncValidationAttribut","eachSeries","done","nextTick","series","next","_asyncValidate","err","timesSeries","res","Validation","_error","_basicFields","_customFields","message","code","reason","newErr","userCode","userError","property","userAlias","result","error","format","validate","alias","_forceType","number","post","n","def","parseFloat","integer","parseInt","string","toString","joinWith","JSON","stringify","date","d","boolean","toLowerCase","parse","e","substring","split","splitWith","_applyRules","upper","toUpperCase","lower","title","txt","charAt","substr","capitalize","ucfirst","trim","_sanitizationAttribut","that","rules","modified","rule","min","postTest","max","str","gap","tmp","_sanitize","execs","_asyncSanitizationAttribut","globing","_asyncSanitize","Sanitization","_reporting","newNot","data","reporting","sanitize","waterfall","reduce","inter","INT_MIN","INT_MAX","_rand","int","Math","random","float","bool","char","fromCharCode","fromList","list","_formatSample","toISOString","toLocaleTimeString","hour12","s","numeric","_getLimits","_typeGenerator","o","prop","generate","rk","randomKey","size","any","CandidateGenerator","_instance","instance","SchemaInspector","module","exports","newSanitization","newValidation","r"],"sources":["D:/Projects/NovaMiningverse/Nova-Miningverse/nova-miningverse-frontend/node_modules/schema-inspector/lib/schema-inspector.js"],"sourcesContent":["/*\n * This module is intended to be executed both on client side and server side.\n * No error should be thrown. (soft error handling)\n */\n\n(function () {\n\tvar root = {};\n\t// Dependencies --------------------------------------------------------------\n\troot.async = (typeof require === 'function') ? require('async') : window.async;\n\tif (typeof root.async !== 'object') {\n\t\tthrow new Error('Module async is required (https://github.com/caolan/async)');\n\t}\n\tvar async = root.async;\n\n\tfunction _extend(origin, add) {\n\t\tif (!add || typeof add !== 'object') {\n\t\t\treturn origin;\n\t\t}\n\t\tvar keys = Object.keys(add);\n\t\tvar i = keys.length;\n\t\twhile (i--) {\n\t\t\torigin[keys[i]] = add[keys[i]];\n\t\t}\n\t\treturn origin;\n\t}\n\n\tfunction _merge() {\n\t\tvar ret = {};\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tvar keys = null;\n\t\tvar i = null;\n\n\t\targs.forEach(function (arg) {\n\t\t\tif (arg && arg.constructor === Object) {\n\t\t\t\tkeys = Object.keys(arg);\n\t\t\t\ti = keys.length;\n\t\t\t\twhile (i--) {\n\t\t\t\t\tret[keys[i]] = arg[keys[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn ret;\n\t}\n\n\t// Customisable class (Base class) -------------------------------------------\n\t// Use with operation \"new\" to extend Validation and Sanitization themselves,\n\t// not their prototype. In other words, constructor shall be call to extend\n\t// those functions, instead of being in their constructor, like this:\n\t//\t\t_extend(Validation, new Customisable);\n\n\tfunction Customisable() {\n\t\tthis.custom = {};\n\n\t\tthis.extend = function (custom) {\n\t\t\treturn _extend(this.custom, custom);\n\t\t};\n\n\t\tthis.reset = function () {\n\t\t\tthis.custom = {};\n\t\t};\n\n\t\tthis.remove = function (fields) {\n\t\t\tif (!_typeIs.array(fields)) {\n\t\t\t\tfields = [fields];\n\t\t\t}\n\t\t\tfields.forEach(function (field) {\n\t\t\t\tdelete this.custom[field];\n\t\t\t}, this);\n\t\t};\n\t}\n\n\t// Inspection class (Base class) ---------------------------------------------\n\t// Use to extend Validation and Sanitization prototypes. Inspection\n\t// constructor shall be called in derived class constructor.\n\n\tfunction Inspection(schema, custom) {\n\t\tvar _stack = ['@'];\n\n\t\tthis._schema = schema;\n\t\tthis._custom = {};\n\t\tif (custom != null) {\n\t\t\tfor (var key in custom) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(custom, key)) {\n\t\t\t\t\tthis._custom['$' + key] = custom[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._getDepth = function () {\n\t\t\treturn _stack.length;\n\t\t};\n\n\t\tthis._dumpStack = function () {\n\t\t\treturn _stack.map(function (i) {return i.replace(/^\\[/g, '\\u001b\\u001c\\u001d\\u001e');})\n\t\t\t.join('.').replace(/\\.\\u001b\\u001c\\u001d\\u001e/g, '[');\n\t\t};\n\n\t\tthis._deeperObject = function (name) {\n\t\t\t_stack.push((/^[a-z$_][a-z0-9$_]*$/i).test(name) ? name : '[\"' + name + '\"]');\n\t\t\treturn this;\n\t\t};\n\n\t\tthis._deeperArray = function (i) {\n\t\t\t_stack.push('[' + i + ']');\n\t\t\treturn this;\n\t\t};\n\n\t\tthis._back = function () {\n\t\t\t_stack.pop();\n\t\t\treturn this;\n\t\t};\n\t}\n\t// Simple types --------------------------------------------------------------\n\t// If the property is not defined or is not in this list:\n\tvar _typeIs = {\n\t\t\"function\": function (element) {\n\t\t\treturn typeof element === 'function';\n\t\t},\n\t\t\"string\": function (element) {\n\t\t\treturn typeof element === 'string';\n\t\t},\n\t\t\"number\": function (element) {\n\t\t\treturn typeof element === 'number' && !isNaN(element);\n\t\t},\n\t\t\"integer\": function (element) {\n\t\t\treturn typeof element === 'number' && element % 1 === 0;\n\t\t},\n\t\t\"NaN\": function (element) {\n\t\t\treturn typeof element === 'number' && isNaN(element);\n\t\t},\n\t\t\"boolean\": function (element) {\n\t\t\treturn typeof element === 'boolean';\n\t\t},\n\t\t\"null\": function (element) {\n\t\t\treturn element === null;\n\t\t},\n\t\t\"date\": function (element) {\n\t\t\treturn element != null && element instanceof Date;\n\t\t},\n\t\t\"object\": function (element) {\n\t\t\treturn typeof element === 'object' && element.constructor !== Array && element != null;\n\t\t},\n\t\t\"array\": function (element) {\n\t\t\treturn element != null && element.constructor === Array;\n\t\t},\n\t\t\"any\": function () {\n\t\t\treturn true;\n\t\t}\n\t};\n\n\tfunction _simpleType(type, candidate) {\n\t\tif (typeof type == 'function') {\n\t\t\treturn candidate instanceof type;\n\t\t}\n\t\ttype = type in _typeIs ? type : 'any';\n\t\treturn _typeIs[type](candidate);\n\t}\n\n\tfunction _realType(candidate) {\n\t\tfor (var i in _typeIs) {\n\t\t\tif (_simpleType(i, candidate)) {\n\t\t\t\tif (i !== 'any' && (i !== 'object' || candidate.constructor === Object)) { return i; }\n\t\t\t\treturn 'an instance of ' + candidate.constructor.name;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getIndexes(a, value) {\n\t\tvar indexes = [];\n\t\tvar i = a.indexOf(value);\n\n\t\twhile (i !== -1) {\n\t\t\tindexes.push(i);\n\t\t\ti = a.indexOf(value, i + 1);\n\t\t}\n\t\treturn indexes;\n\t}\n\n\t// Available formats ---------------------------------------------------------\n\tvar _formats = {\n\t\t'void': /^$/,\n\t\t'url': /^(https?|ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)?(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i,\n\t\t'date-time': /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?(Z?|(-|\\+)\\d{2}:\\d{2})$/,\n\t\t'date': /^\\d{4}-\\d{2}-\\d{2}$/,\n\t\t'coolDateTime': /^\\d{4}(-|\\/)\\d{2}(-|\\/)\\d{2}(T| )\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$/,\n\t\t'time': /^\\d{2}\\:\\d{2}\\:\\d{2}$/,\n\t\t'color': /^#([0-9a-f])+$/i,\n\t\t// 2021-03-13 - Email regex was replaced with result of running email-safe-regex\n\t\t// latest version as of that day in order so fix GHSL-2020-35.\n\t\t// const emailRegexSafe = require('email-regex-safe');\n\t\t// const regexString = emailRegexSafe({\n    \t//   exact: true,\n    \t//   returnString: true,\n\t\t// });\n\t\t// <using debugger to inspect state of regexString after previous statement>\n\t\t//\n\t\t// Note that this regex is pretty flexible, but it's a bit stricter than\n\t\t// what we had before. It requires the local part of the email address to\n\t\t// be at least two characters. Was able to find some justification for\n\t\t// this at https://stackoverflow.com/a/15783334/5051165. Test suite\n\t\t// was corrected accordingly.\n\t\t'email': new RegExp(`(?:[^\\\\W_](?:[\\\\w\\\\.\\\\+]+)@(?:localhost|(?:25[0-5]|2[0-4]\\\\d|1\\\\d\\\\d|[1-9]\\\\d|\\\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\\\d|1\\\\d\\\\d|[1-9]\\\\d|\\\\d)){3}|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9][-_]*)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:northwesternmutual|travelersinsurance|vermögensberatung|vermögensberater|americanexpress|kerryproperties|sandvikcoromant|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|construction|lplfinancial|scholarships|versicherung|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|موريتانيا|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|السعودية|yokohama|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|католик|الجزائر|العليان|اتصالات|پاکستان|البحرين|كاثوليك|இந்தியா|yamaxun|youtube|zuerich|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|москва|онлайн|ファッション|भारतम्|ارامكو|امارات|الاردن|المغرب|ابوظبي|مليسيا|இலங்கை|فلسطين|yachts|yandex|zappos|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|ישראל|বাংলা|భారత్|भारोत|संगठन|ایران|بازار|بھارت|سودان|همراه|سورية|ഭാരതം|嘉里大酒店|yahoo|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|ಭಾರತ|ଭାରତ|大众汽车|ভাৰত|ভারত|موقع|香格里拉|сайт|アマゾン|дети|ポイント|ලංකා|電訊盈科|クラウド|ભારત|भारत|عمان|بارت|ڀارت|عراق|شبكة|بيتك|组织机构|تونس|グーグル|ਭਾਰਤ|yoga|zara|zero|zone|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|कॉम|セール|คอม|我爱你|қаз|срб|бел|קום|淡马锡|орг|नेट|ストア|мкд|كوم|中文网|ком|укр|亚马逊|诺基亚|飞利浦|мон|عرب|ไทย|рус|ລາວ|みんな|天主教|مصر|قطر|հայ|新加坡|xxx|xyz|you|yun|zip|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|佛山|慈善|集团|在线|한국|点看|八卦|公益|公司|网站|移动|联通|бг|时尚|微博|삼성|商标|商店|商城|ею|新闻|家電|中信|中国|中國|娱乐|谷歌|购物|通販|网店|餐厅|网络|香港|食品|台湾|台灣|手机|澳門|닷컴|政府|გე|机构|健康|招聘|рф|大拿|ευ|ελ|世界|書籍|网址|닷넷|コム|游戏|企业|信息|嘉里|广东|政务|ye|yt|za|zm|zw))))`),\n\t\t'numeric': /^[0-9]+$/,\n\t\t'integer': /^\\-?[0-9]+$/,\n\t\t'decimal': /^\\-?[0-9]*\\.?[0-9]+$/,\n\t\t'alpha': /^[a-z]+$/i,\n\t\t'alphaNumeric': /^[a-z0-9]+$/i,\n\t\t'alphaDash': /^[a-z0-9_-]+$/i,\n\t\t'javascript': /^[a-z_\\$][a-z0-9_\\$]*$/i,\n\t\t'upperString': /^[A-Z ]*$/,\n\t\t'lowerString': /^[a-z ]*$/,\n\t\t'v4uuid': /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}$/i\n\t};\n\n// Validation ------------------------------------------------------------------\n\tvar _validationAttribut = {\n\t\toptional: function (schema, candidate) {\n\t\t\tvar opt = typeof schema.optional === 'boolean' ? schema.optional : (schema.optional === 'true'); // Default is false\n\n\t\t\tif (opt === true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof candidate === 'undefined') {\n\t\t\t\tthis.report('is missing and not optional', null, 'optional');\n\t\t\t}\n\t\t},\n\t\ttype: function (schema, candidate) {\n\t\t\t// return because optional function already handle this case\n\t\t\tif (typeof candidate === 'undefined' || (typeof schema.type !== 'string' && !(schema.type instanceof Array) && typeof schema.type !== 'function')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar types = _typeIs.array(schema.type) ? schema.type : [schema.type];\n\t\t\tvar typeIsValid = types.some(function (type) {\n\t\t\t\treturn _simpleType(type, candidate);\n\t\t\t});\n\t\t\tif (!typeIsValid) {\n\t\t\t\ttypes = types.map(function (t) {return typeof t === 'function' ? 'an instance of ' + t.name : t; });\n\t\t\t\tthis.report('must be ' + types.join(' or ') + ', but is ' + _realType(candidate), null, 'type');\n\t\t\t}\n\t\t},\n\t\tuniqueness: function (schema, candidate) {\n\t\t\tif (typeof schema.uniqueness === 'string') { schema.uniqueness = (schema.uniqueness === 'true'); }\n\t\t\tif (typeof schema.uniqueness !== 'boolean' || schema.uniqueness === false || (!_typeIs.array(candidate) && typeof candidate !== 'string')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar reported = [];\n\t\t\tfor (var i = 0; i < candidate.length; i++) {\n\t\t\t\tif (reported.indexOf(candidate[i]) >= 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar indexes = getIndexes(candidate, candidate[i]);\n\t\t\t\tif (indexes.length > 1) {\n\t\t\t\t\treported.push(candidate[i]);\n\t\t\t\t\tthis.report('has value [' + candidate[i] + '] more than once at indexes [' + indexes.join(', ') + ']', null, 'uniqueness');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tpattern: function (schema, candidate) {\n\t\t\tvar self = this;\n\t\t\tvar regexs = schema.pattern;\n\t\t\tif (typeof candidate !== 'string') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar matches = false;\n\t\t\tif (!_typeIs.array(regexs)) {\n\t\t\t\tregexs = [regexs];\n\t\t\t}\n\t\t\tregexs.forEach(function (regex) {\n\t\t\t\tif (typeof regex === 'string' && regex in _formats) {\n\t\t\t\t\tregex = _formats[regex];\n\t\t\t\t}\n\t\t\t\tif (regex instanceof RegExp) {\n\t\t\t\t\tif (regex.test(candidate)) {\n\t\t\t\t\t\tmatches = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!matches) {\n\t\t\t\tself.report('must match [' + regexs.join(' or ') + '], but is equal to \"' + candidate + '\"', null, 'pattern');\n\t\t\t}\n\t\t},\n\t\tvalidDate: function (schema, candidate) {\n\t\t\tif (String(schema.validDate) === 'true' && candidate instanceof Date && isNaN(candidate.getTime())) {\n\t\t\t\tthis.report('must be a valid date', null, 'validDate');\n\t\t\t}\n\t\t},\n\t\tminLength: function (schema, candidate) {\n\t\t\tif (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar minLength = Number(schema.minLength);\n\t\t\tif (isNaN(minLength)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate.length < minLength) {\n\t\t\t\tthis.report('must be longer than ' + minLength + ' elements, but it has ' + candidate.length, null, 'minLength');\n\t\t\t}\n\t\t},\n\t\tmaxLength: function (schema, candidate) {\n\t\t\tif (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar maxLength = Number(schema.maxLength);\n\t\t\tif (isNaN(maxLength)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate.length > maxLength) {\n\t\t\t\tthis.report('must be shorter than ' + maxLength + ' elements, but it has ' + candidate.length, null, 'maxLength');\n\t\t\t}\n\t\t},\n\t\texactLength: function (schema, candidate) {\n\t\t\tif (typeof candidate !== 'string' && !_typeIs.array(candidate)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar exactLength = Number(schema.exactLength);\n\t\t\tif (isNaN(exactLength)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate.length !== exactLength) {\n\t\t\t\tthis.report('must have exactly ' + exactLength + ' elements, but it have ' + candidate.length, null, 'exactLength');\n\t\t\t}\n\t\t},\n\t\tlt: function (schema, candidate) {\n\t\t\tvar limit = Number(schema.lt);\n\t\t\tif (typeof candidate !== 'number' || isNaN(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate >= limit) {\n\t\t\t\tthis.report('must be less than ' + limit + ', but is equal to \"' + candidate + '\"', null, 'lt');\n\t\t\t}\n\t\t},\n\t\tlte: function (schema, candidate) {\n\t\t\tvar limit = Number(schema.lte);\n\t\t\tif (typeof candidate !== 'number' || isNaN(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate > limit) {\n\t\t\t\tthis.report('must be less than or equal to ' + limit + ', but is equal to \"' + candidate + '\"', null, 'lte');\n\t\t\t}\n\t\t},\n\t\tgt: function (schema, candidate) {\n\t\t\tvar limit = Number(schema.gt);\n\t\t\tif (typeof candidate !== 'number' || isNaN(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate <= limit) {\n\t\t\t\tthis.report('must be greater than ' + limit + ', but is equal to \"' + candidate + '\"', null, 'gt');\n\t\t\t}\n\t\t},\n\t\tgte: function (schema, candidate) {\n\t\t\tvar limit = Number(schema.gte);\n\t\t\tif (typeof candidate !== 'number' || isNaN(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (candidate < limit) {\n\t\t\t\tthis.report('must be greater than or equal to ' + limit + ', but is equal to \"' + candidate + '\"', null, 'gte');\n\t\t\t}\n\t\t},\n\t\teq: function (schema, candidate) {\n\t\t\tif (typeof candidate !== 'number' && typeof candidate !== 'string' && typeof candidate !== 'boolean') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar limit = schema.eq;\n\t\t\tif (typeof limit !== 'number' && typeof limit !== 'string' && typeof limit !== 'boolean' && !_typeIs.array(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_typeIs.array(limit)) {\n\t\t\t\tfor (var i = 0; i < limit.length; i++) {\n\t\t\t\t\tif (candidate === limit[i]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.report('must be equal to [' + limit.map(function (l) {\n\t\t\t\t\treturn '\"' + l + '\"';\n\t\t\t\t}).join(' or ') + '], but is equal to \"' + candidate + '\"', null, 'eq');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (candidate !== limit) {\n\t\t\t\t\tthis.report('must be equal to \"' + limit + '\", but is equal to \"' + candidate + '\"', null, 'eq');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tne: function (schema, candidate) {\n\t\t\tif (typeof candidate !== 'number' && typeof candidate !== 'string') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar limit = schema.ne;\n\t\t\tif (typeof limit !== 'number' && typeof limit !== 'string' && !_typeIs.array(limit)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_typeIs.array(limit)) {\n\t\t\t\tfor (var i = 0; i < limit.length; i++) {\n\t\t\t\t\tif (candidate === limit[i]) {\n\t\t\t\t\t\tthis.report('must not be equal to \"' + limit[i] + '\"', null, 'ne');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (candidate === limit) {\n\t\t\t\t\tthis.report('must not be equal to \"' + limit + '\"', null, 'ne');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsomeKeys: function (schema, candidat) {\n\t\t\tvar _keys = schema.someKeys;\n\t\t\tif (!_typeIs.object(candidat)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar valid = _keys.some(function (action) {\n\t\t\t\treturn (action in candidat);\n\t\t\t});\n\t\t\tif (!valid) {\n\t\t\t\tthis.report('must have at least key ' + _keys.map(function (i) {\n\t\t\t\t\treturn '\"' + i + '\"';\n\t\t\t\t}).join(' or '), null, 'someKeys');\n\t\t\t}\n\t\t},\n\t\tstrict: function (schema, candidate) {\n\t\t\tif (typeof schema.strict === 'string') { schema.strict = (schema.strict === 'true'); }\n\t\t\tif (schema.strict !== true || !_typeIs.object(candidate) || !_typeIs.object(schema.properties)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar self = this;\n\t\t\tif (typeof schema.properties['*'] === 'undefined') {\n\t\t\t\tvar intruder = Object.keys(candidate).filter(function (key) {\n\t\t\t\t\treturn (typeof schema.properties[key] === 'undefined');\n\t\t\t\t});\n\t\t\t\tif (intruder.length > 0) {\n\t\t\t\t\tvar msg = 'should not contains ' + (intruder.length > 1 ? 'properties' : 'property') +\n\t\t\t\t\t\t' [' + intruder.map(function (i) { return '\"' + i + '\"'; }).join(', ') + ']';\n\t\t\t\t\tself.report(msg, null, 'strict');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\texec: function (schema, candidate, callback) {\n\t\t\tvar self = this;\n\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncExec(schema, candidate, callback);\n\t\t\t}\n\t\t\t(_typeIs.array(schema.exec) ? schema.exec : [schema.exec]).forEach(function (exec) {\n\t\t\t\tif (typeof exec === 'function') {\n\t\t\t\t\texec.call(self, schema, candidate);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tproperties: function (schema, candidate, callback) {\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncProperties(schema, candidate, callback);\n\t\t\t}\n\t\t\tif (!(schema.properties instanceof Object) || !(candidate instanceof Object)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar properties = schema.properties,\n\t\t\t\t\ti;\n\t\t\tif (properties['*'] != null) {\n\t\t\t\tfor (i in candidate) {\n\t\t\t\t\tif (i in properties) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tthis._deeperObject(i);\n\t\t\t\t\tthis._validate(properties['*'], candidate[i]);\n\t\t\t\t\tthis._back();\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (i in properties) {\n\t\t\t\tif (i === '*') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis._deeperObject(i);\n\t\t\t\tthis._validate(properties[i], candidate[i]);\n\t\t\t\tthis._back();\n\t\t\t}\n\t\t},\n\t\titems: function (schema, candidate, callback) {\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncItems(schema, candidate, callback);\n\t\t\t}\n\t\t\tif (!(schema.items instanceof Object) || !(candidate instanceof Object)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar items = schema.items;\n\t\t\tvar i, l;\n\t\t\t// If provided schema is an array\n\t\t\t// then call validate for each case\n\t\t\t// else it is an Object\n\t\t\t// then call validate for each key\n\t\t\tif (_typeIs.array(items) && _typeIs.array(candidate)) {\n\t\t\t\tfor (i = 0, l = items.length; i < l; i++) {\n\t\t\t\t\tthis._deeperArray(i);\n\t\t\t\t\tthis._validate(items[i], candidate[i]);\n\t\t\t\t\tthis._back();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (var key in candidate) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(candidate, key)) {\n\t\t\t\t\t\tthis._deeperArray(key);\n\t\t\t\t\t\tthis._validate(items, candidate[key]);\n\t\t\t\t\t\tthis._back();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tvar _asyncValidationAttribut = {\n\t\tasyncExec: function (schema, candidate, callback) {\n\t\t\tvar self = this;\n\t\t\tasync.eachSeries(_typeIs.array(schema.exec) ? schema.exec : [schema.exec], function (exec, done) {\n\t\t\t\tif (typeof exec === 'function') {\n\t\t\t\t\tif (exec.length > 2) {\n\t\t\t\t\t\treturn exec.call(self, schema, candidate, done);\n\t\t\t\t\t}\n\t\t\t\t\texec.call(self, schema, candidate);\n\t\t\t\t}\n\t\t\t\tasync.nextTick(done);\n\t\t\t}, callback);\n\t\t},\n\t\tasyncProperties: function (schema, candidate, callback) {\n\t\t\tif (!(schema.properties instanceof Object) || !_typeIs.object(candidate)) {\n\t\t\t\treturn callback();\n\t\t\t}\n\t\t\tvar self = this;\n\t\t\tvar properties = schema.properties;\n\t\t\tasync.series([\n\t\t\t\tfunction (next) {\n\t\t\t\t\tif (properties['*'] == null) {\n\t\t\t\t\t\treturn next();\n\t\t\t\t\t}\n\t\t\t\t\tasync.eachSeries(Object.keys(candidate), function (i, done) {\n\t\t\t\t\t\tif (i in properties) {\n\t\t\t\t\t\t\treturn async.nextTick(done);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._deeperObject(i);\n\t\t\t\t\t\tself._asyncValidate(properties['*'], candidate[i], function (err) {\n\t\t\t\t\t\t\tself._back();\n\t\t\t\t\t\t\tdone(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, next);\n\t\t\t\t},\n\t\t\t\tfunction (next) {\n\t\t\t\t\tasync.eachSeries(Object.keys(properties), function (i, done) {\n\t\t\t\t\t\tif (i === '*') {\n\t\t\t\t\t\t\treturn async.nextTick(done);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._deeperObject(i);\n\t\t\t\t\t\tself._asyncValidate(properties[i], candidate[i], function (err) {\n\t\t\t\t\t\t\tself._back();\n\t\t\t\t\t\t\tdone(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, next);\n\t\t\t\t}\n\t\t\t], callback);\n\t\t},\n\t\tasyncItems: function (schema, candidate, callback) {\n\t\t\tif (!(schema.items instanceof Object) || !(candidate instanceof Object)) {\n\t\t\t\treturn callback();\n\t\t\t}\n\t\t\tvar self = this;\n\t\t\tvar items = schema.items;\n\t\t\tvar i, l;\n\n\t\t\tif (_typeIs.array(items) && _typeIs.array(candidate)) {\n\t\t\t\tasync.timesSeries(items.length, function (i, done) {\n\t\t\t\t\tself._deeperArray(i);\n\t\t\t\t\tself._asyncValidate(items[i], candidate[i], function (err, res) {\n\t\t\t\t\t\tself._back();\n\t\t\t\t\t\tdone(err, res);\n\t\t\t\t\t});\n\t\t\t\t\tself._back();\n\t\t\t\t}, callback);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tasync.eachSeries(Object.keys(candidate), function (key, done) {\n\t\t\t\t\tself._deeperArray(key);\n\t\t\t\t\tself._asyncValidate(items, candidate[key], function (err, res) {\n\t\t\t\t\t\tself._back();\n\t\t\t\t\t\tdone(err, res);\n\t\t\t\t\t});\n\t\t\t\t}, callback);\n\t\t\t}\n\t\t}\n\t};\n\n\t// Validation Class ----------------------------------------------------------\n\t// inherits from Inspection class (actually we just call Inspection\n\t// constructor with the new context, because its prototype is empty\n\tfunction Validation(schema, custom) {\n\t\tInspection.prototype.constructor.call(this, schema, _merge(Validation.custom, custom));\n\t\tvar _error = [];\n\n\t\tthis._basicFields = Object.keys(_validationAttribut);\n\t\tthis._customFields = Object.keys(this._custom);\n\t\tthis.origin = null;\n\n\t\tthis.report = function (message, code, reason) {\n\t\t\tvar newErr = {\n\t\t\t\tcode: code || this.userCode || null,\n\t\t\t\treason: reason || 'unknown',\n\t\t\t\tmessage: this.userError || message || 'is invalid',\n\t\t\t\tproperty: this.userAlias ? (this.userAlias + ' (' + this._dumpStack() + ')') : this._dumpStack()\n\t\t\t};\n\t\t\t_error.push(newErr);\n\t\t\treturn this;\n\t\t};\n\n\t\tthis.result = function () {\n\t\t\treturn {\n\t\t\t\terror: _error,\n\t\t\t\tvalid: _error.length === 0,\n\t\t\t\tformat: function () {\n\t\t\t\t\tif (this.valid === true) {\n\t\t\t\t\t\treturn 'Candidate is valid';\n\t\t\t\t\t}\n\t\t\t\t\treturn this.error.map(function (i) {\n\t\t\t\t\t\treturn 'Property ' + i.property + ': ' + i.message;\n\t\t\t\t\t}).join('\\n');\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}\n\n\t_extend(Validation.prototype, _validationAttribut);\n\t_extend(Validation.prototype, _asyncValidationAttribut);\n\t_extend(Validation, new Customisable());\n\n\tValidation.prototype.validate = function (candidate, callback) {\n\t\tthis.origin = candidate;\n\t\tif (typeof callback === 'function') {\n\t\t\tvar self = this;\n\t\t\treturn async.nextTick(function () {\n\t\t\t\tself._asyncValidate(self._schema, candidate, function (err) {\n\t\t\t\t\tself.origin = null;\n\t\t\t\t\tcallback(err, self.result());\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn this._validate(this._schema, candidate).result();\n\t};\n\n\tValidation.prototype._validate = function (schema, candidate, callback) {\n\t\tthis.userCode = schema.code || null;\n\t\tthis.userError = schema.error || null;\n\t\tthis.userAlias = schema.alias || null;\n\t\tthis._basicFields.forEach(function (i) {\n\t\t\tif ((i in schema || i === 'optional') && typeof this[i] === 'function') {\n\t\t\t\tthis[i](schema, candidate);\n\t\t\t}\n\t\t}, this);\n\t\tthis._customFields.forEach(function (i) {\n\t\t\tif (i in schema && typeof this._custom[i] === 'function') {\n\t\t\t\tthis._custom[i].call(this, schema, candidate);\n\t\t\t}\n\t\t}, this);\n\t\treturn this;\n\t};\n\n\tValidation.prototype._asyncValidate = function (schema, candidate, callback) {\n\t\tvar self = this;\n\t\tthis.userCode = schema.code || null;\n\t\tthis.userError = schema.error || null;\n\t\tthis.userAlias = schema.alias || null;\n\n\t\tasync.series([\n\t\t\tfunction (next) {\n\t\t\t\tasync.eachSeries(Object.keys(_validationAttribut), function (i, done) {\n\t\t\t\t\tasync.nextTick(function () {\n\t\t\t\t\t\tif ((i in schema || i === 'optional') && typeof self[i] === 'function') {\n\t\t\t\t\t\t\tif (self[i].length > 2) {\n\t\t\t\t\t\t\t\treturn self[i](schema, candidate, done);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself[i](schema, candidate);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdone();\n\t\t\t\t\t});\n\t\t\t\t}, next);\n\t\t\t},\n\t\t\tfunction (next) {\n\t\t\t\tasync.eachSeries(Object.keys(self._custom), function (i, done) {\n\t\t\t\t\tasync.nextTick(function () {\n\t\t\t\t\t\tif (i in schema && typeof self._custom[i] === 'function') {\n\t\t\t\t\t\t\tif (self._custom[i].length > 2) {\n\t\t\t\t\t\t\t\treturn self._custom[i].call(self, schema, candidate, done);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself._custom[i].call(self, schema, candidate);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdone();\n\t\t\t\t\t});\n\t\t\t\t}, next);\n\t\t\t}\n\t\t], callback);\n\t};\n\n\t// Sanitization ----------------------------------------------------------------\n\t// functions called by _sanitization.type method.\n\tvar _forceType = {\n\t\tnumber: function (post, schema) {\n\t\t\tvar n;\n\t\t\tif (typeof post === 'number') {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\telse if (post === '') {\n\t\t\t\tif (typeof schema.def !== 'undefined')\n\t\t\t\t\treturn schema.def;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse if (typeof post === 'string') {\n\t\t\t\tn = parseFloat(post.replace(/,/g, '.').replace(/ /g, ''));\n\t\t\t\tif (typeof n === 'number') {\n\t\t\t\t\treturn n;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (post instanceof Date) {\n\t\t\t\treturn +post;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tinteger: function (post, schema) {\n\t\t\tvar n;\n\t\t\tif (typeof post === 'number' && post % 1 === 0) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\telse if (post === '') {\n\t\t\t\tif (typeof schema.def !== 'undefined')\n\t\t\t\t\treturn schema.def;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse if (typeof post === 'string') {\n\t\t\t\tn = parseInt(post.replace(/ /g, ''), 10);\n\t\t\t\tif (typeof n === 'number') {\n\t\t\t\t\treturn n;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (typeof post === 'number') {\n\t\t\t\treturn parseInt(post, 10);\n\t\t\t}\n\t\t\telse if (typeof post === 'boolean') {\n\t\t\t\tif (post) { return 1; }\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if (post instanceof Date) {\n\t\t\t\treturn +post;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tstring: function (post, schema) {\n\t\t\tif (typeof post === 'boolean' || typeof post === 'number' || post instanceof Date) {\n\t\t\t\treturn post.toString();\n\t\t\t}\n\t\t\telse if (_typeIs.array(post)) {\n\t\t\t\t// If user authorize array and strings...\n\t\t\t\tif (schema.items || schema.properties)\n\t\t\t\t\treturn post;\n\t\t\t\treturn post.join(String(schema.joinWith || ','));\n\t\t\t}\n\t\t\telse if (post instanceof Object) {\n\t\t\t\t// If user authorize objects ans strings...\n\t\t\t\tif (schema.items || schema.properties)\n\t\t\t\t\treturn post;\n\t\t\t\treturn JSON.stringify(post);\n\t\t\t}\n\t\t\telse if (typeof post === 'string' && post.length) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tdate: function (post, schema) {\n\t\t\tif (post instanceof Date) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar d = new Date(post);\n\t\t\t\tif (!isNaN(d.getTime())) { // if valid date\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tboolean: function (post, schema) {\n\t\t\tif (typeof post === 'undefined') return null;\n\t\t\tif (typeof post === 'string' && post.toLowerCase() === 'false') return false;\n\t\t\treturn !!post;\n\t\t},\n\t\tobject: function (post, schema) {\n\t\t\tif (typeof post !== 'string' || _typeIs.object(post)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(post);\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tarray: function (post, schema) {\n\t\t\tif (_typeIs.array(post))\n\t\t\t\treturn post;\n\t\t\tif (typeof post === 'undefined')\n\t\t\t\treturn null;\n\t\t\tif (typeof post === 'string') {\n\t\t\t\tif (post.substring(0,1) === '[' && post.slice(-1) === ']') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn JSON.parse(post);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn post.split(String(schema.splitWith || ','));\n\n\t\t\t}\n\t\t\tif (!_typeIs.array(post))\n\t\t\t\treturn [ post ];\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tvar _applyRules = {\n\t\tupper: function (post) {\n\t\t\treturn post.toUpperCase();\n\t\t},\n\t\tlower: function (post) {\n\t\t\treturn post.toLowerCase();\n\t\t},\n\t\ttitle: function (post) {\n\t\t\t// Fix by seb (replace \\w\\S* by \\S* => exemple : coucou ça va)\n\t\t\treturn post.replace(/\\S*/g, function (txt) {\n\t\t\t\treturn txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n\t\t\t});\n\t\t},\n\t\tcapitalize: function (post) {\n\t\t\treturn post.charAt(0).toUpperCase() + post.substr(1).toLowerCase();\n\t\t},\n\t\tucfirst: function (post) {\n\t\t\treturn post.charAt(0).toUpperCase() + post.substr(1);\n\t\t},\n\t\ttrim: function (post) {\n\t\t\treturn post.trim();\n\t\t}\n\t};\n\n\t// Every function return the future value of each property. Therefore you\n\t// have to return post even if you do not change its value\n\tvar _sanitizationAttribut = {\n\t\tstrict: function (schema, post) {\n\t\t\tif (typeof schema.strict === 'string') { schema.strict = (schema.strict === 'true'); }\n\t\t\tif (schema.strict !== true)\n\t\t\t\treturn post;\n\t\t\tif (!_typeIs.object(schema.properties))\n\t\t\t\treturn post;\n\t\t\tif (!_typeIs.object(post))\n\t\t\t\treturn post;\n\t\t\tvar that = this;\n\t\t\tObject.keys(post).forEach(function (key) {\n\t\t\t\tif (!(key in schema.properties)) {\n\t\t\t\t\tdelete post[key];\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn post;\n\t\t},\n\t\toptional: function (schema, post) {\n\t\t\tvar opt = typeof schema.optional === 'boolean' ? schema.optional : (schema.optional !== 'false'); // Default: true\n\t\t\tif (opt === true) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tif (typeof post !== 'undefined') {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tthis.report();\n\t\t\tif (schema.def === Date) {\n\t\t\t\treturn new Date();\n\t\t\t}\n\t\t\treturn schema.def;\n\t\t},\n\t\ttype: function (schema, post) {\n\t\t\t// if (_typeIs['object'](post) || _typeIs.array(post)) {\n\t\t\t// \treturn post;\n\t\t\t// }\n\t\t\tif (typeof schema.type !== 'string' || typeof _forceType[schema.type] !== 'function') {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar n;\n\t\t\tvar opt = typeof schema.optional === 'boolean' ? schema.optional : true;\n\t\t\tif (typeof _forceType[schema.type] === 'function') {\n\t\t\t\tn = _forceType[schema.type](post, schema);\n\t\t\t\tif ((n === null && !opt) || (!n && isNaN(n)) || (n === null && schema.type === 'string')) {\n\t\t\t\t\tn = schema.def;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!opt) {\n\t\t\t\tn = schema.def;\n\t\t\t}\n\t\t\tif ((n != null || (typeof schema.def !== 'undefined' && schema.def === n)) && n !== post) {\n\t\t\t\tthis.report();\n\t\t\t\treturn n;\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\trules: function (schema, post) {\n\t\t\tvar rules = schema.rules;\n\t\t\tif (typeof post !== 'string' || (typeof rules !== 'string' && !_typeIs.array(rules))) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar modified = false;\n\t\t\t(_typeIs.array(rules) ? rules : [rules]).forEach(function (rule) {\n\t\t\t\tif (typeof _applyRules[rule] === 'function') {\n\t\t\t\t\tpost = _applyRules[rule](post);\n\t\t\t\t\tmodified = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (modified) {\n\t\t\t\tthis.report();\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\tmin: function (schema, post) {\n\t\t\tvar postTest = Number(post);\n\t\t\tif (isNaN(postTest)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar min = Number(schema.min);\n\t\t\tif (isNaN(min)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tif (postTest < min) {\n\t\t\t\tthis.report();\n\t\t\t\treturn min;\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\tmax: function (schema, post) {\n\t\t\tvar postTest = Number(post);\n\t\t\tif (isNaN(postTest)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar max = Number(schema.max);\n\t\t\tif (isNaN(max)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tif (postTest > max) {\n\t\t\t\tthis.report();\n\t\t\t\treturn max;\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\tminLength: function (schema, post) {\n\t\t\tvar limit = Number(schema.minLength);\n\t\t\tif (typeof post !== 'string' || isNaN(limit) || limit < 0) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar str = '';\n\t\t\tvar gap = limit - post.length;\n\t\t\tif (gap > 0) {\n\t\t\t\tfor (var i = 0; i < gap; i++) {\n\t\t\t\t\tstr += '-';\n\t\t\t\t}\n\t\t\t\tthis.report();\n\t\t\t\treturn post + str;\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\tmaxLength: function (schema, post) {\n\t\t\tvar limit = Number(schema.maxLength);\n\t\t\tif (typeof post !== 'string' || isNaN(limit) || limit < 0) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tif (post.length > limit) {\n\t\t\t\tthis.report();\n\t\t\t\treturn post.slice(0, limit);\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\tproperties: function (schema, post, callback) {\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncProperties(schema, post, callback);\n\t\t\t}\n\t\t\tif (!post || typeof post !== 'object') {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar properties = schema.properties;\n\t\t\tvar tmp;\n\t\t\tvar i;\n\t\t\tif (typeof properties['*'] !== 'undefined') {\n\t\t\t\tfor (i in post) {\n\t\t\t\t\tif (i in properties) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tthis._deeperObject(i);\n\t\t\t\t\ttmp = this._sanitize(schema.properties['*'], post[i]);\n\t\t\t\t\tif (typeof tmp !== 'undefined') {\n\t\t\t\t\t\tpost[i]= tmp;\n\t\t\t\t\t}\n\t\t\t\t\tthis._back();\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (i in schema.properties) {\n\t\t\t\tif (i !== '*') {\n\t\t\t\t\tthis._deeperObject(i);\n\t\t\t\t\ttmp = this._sanitize(schema.properties[i], post[i]);\n\t\t\t\t\tif (typeof tmp !== 'undefined') {\n\t\t\t\t\t\tpost[i]= tmp;\n\t\t\t\t\t}\n\t\t\t\t\tthis._back();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\titems: function (schema, post, callback) {\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncItems(schema, post, callback);\n\t\t\t}\n\t\t\tif (!(schema.items instanceof Object) || !(post instanceof Object)) {\n\t\t\t\treturn post;\n\t\t\t}\n\t\t\tvar i;\n\t\t\tif (_typeIs.array(schema.items) && _typeIs.array(post)) {\n\t\t\t\tvar minLength = schema.items.length < post.length ? schema.items.length : post.length;\n\t\t\t\tfor (i = 0; i < minLength; i++) {\n\t\t\t\t\tthis._deeperArray(i);\n\t\t\t\t\tpost[i] = this._sanitize(schema.items[i], post[i]);\n\t\t\t\t\tthis._back();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (i in post) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(post, i)) {\n\t\t\t\t\t\tthis._deeperArray(i);\n\t\t\t\t\t\tpost[i] = this._sanitize(schema.items, post[i]);\n\t\t\t\t\t\tthis._back();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn post;\n\t\t},\n\t\texec: function (schema, post, callback) {\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\treturn this.asyncExec(schema, post, callback);\n\t\t\t}\n\t\t\tvar execs = _typeIs.array(schema.exec) ? schema.exec : [schema.exec];\n\n\t\t\texecs.forEach(function (exec) {\n\t\t\t\tif (typeof exec === 'function') {\n\t\t\t\t\tpost = exec.call(this, schema, post);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\treturn post;\n\t\t}\n\t};\n\n\tvar _asyncSanitizationAttribut = {\n\t\tasyncExec: function (schema, post, callback) {\n\t\t\tvar self = this;\n\t\t\tvar execs = _typeIs.array(schema.exec) ? schema.exec : [schema.exec];\n\n\t\t\tasync.eachSeries(execs, function (exec, done) {\n\t\t\t\tif (typeof exec === 'function') {\n\t\t\t\t\tif (exec.length > 2) {\n\t\t\t\t\t\treturn exec.call(self, schema, post, function (err, res) {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\treturn done(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpost = res;\n\t\t\t\t\t\t\tdone();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tpost = exec.call(self, schema, post);\n\t\t\t\t}\n\t\t\t\tdone();\n\t\t\t}, function (err) {\n\t\t\t\tcallback(err, post);\n\t\t\t});\n\t\t},\n\t\tasyncProperties: function (schema, post, callback) {\n\t\t\tif (!post || typeof post !== 'object') {\n\t\t\t\treturn callback(null, post);\n\t\t\t}\n\t\t\tvar self = this;\n\t\t\tvar properties = schema.properties;\n\n\t\t\tasync.series([\n\t\t\t\tfunction (next) {\n\t\t\t\t\tif (properties['*'] == null) {\n\t\t\t\t\t\treturn next();\n\t\t\t\t\t}\n\t\t\t\t\tvar globing = properties['*'];\n\t\t\t\t\tasync.eachSeries(Object.keys(post), function (i, next) {\n\t\t\t\t\t\tif (i in properties) {\n\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._deeperObject(i);\n\t\t\t\t\t\tself._asyncSanitize(globing, post[i], function (err, res) {\n\t\t\t\t\t\t\tif (err) { /* Error can safely be ignored here */ }\n\t\t\t\t\t\t\tif (typeof res !== 'undefined') {\n\t\t\t\t\t\t\t\tpost[i] = res;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself._back();\n\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t});\n\t\t\t\t\t}, next);\n\t\t\t\t},\n\t\t\t\tfunction (next) {\n\t\t\t\t\tasync.eachSeries(Object.keys(properties), function (i, next) {\n\t\t\t\t\t\tif (i === '*') {\n\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._deeperObject(i);\n\t\t\t\t\t\tself._asyncSanitize(properties[i], post[i], function (err, res) {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\treturn next(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof res !== 'undefined') {\n\t\t\t\t\t\t\t\tpost[i] = res;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself._back();\n\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t});\n\t\t\t\t\t}, next);\n\t\t\t\t}\n\t\t\t], function (err) {\n\t\t\t\treturn callback(err, post);\n\t\t\t});\n\t\t},\n\t\tasyncItems: function (schema, post, callback) {\n\t\t\tif (!(schema.items instanceof Object) || !(post instanceof Object)) {\n\t\t\t\treturn callback(null, post);\n\t\t\t}\n\t\t\tvar self = this;\n\t\t\tvar items = schema.items;\n\t\t\tif (_typeIs.array(items) && _typeIs.array(post)) {\n\t\t\t\tvar minLength = items.length < post.length ? items.length : post.length;\n\t\t\t\tasync.timesSeries(minLength, function (i, next) {\n\t\t\t\t\tself._deeperArray(i);\n\t\t\t\t\tself._asyncSanitize(items[i], post[i], function (err, res) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn next(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpost[i] = res;\n\t\t\t\t\t\tself._back();\n\t\t\t\t\t\tnext();\n\t\t\t\t\t});\n\t\t\t\t}, function (err) {\n\t\t\t\t\tcallback(err, post);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tasync.eachSeries(Object.keys(post), function (key, next) {\n\t\t\t\t\tself._deeperArray(key);\n\t\t\t\t\tself._asyncSanitize(items, post[key], function (err, res) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpost[key] = res;\n\t\t\t\t\t\tself._back();\n\t\t\t\t\t\tnext();\n\t\t\t\t\t});\n\t\t\t\t}, function (err) {\n\t\t\t\t\tcallback(err, post);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn post;\n\t\t}\n\t};\n\n\t// Sanitization Class --------------------------------------------------------\n\t// inherits from Inspection class (actually we just call Inspection\n\t// constructor with the new context, because its prototype is empty\n\tfunction Sanitization(schema, custom) {\n\t\tInspection.prototype.constructor.call(this, schema, _merge(Sanitization.custom, custom));\n\t\tvar _reporting = [];\n\n\t\tthis._basicFields = Object.keys(_sanitizationAttribut);\n\t\tthis._customFields = Object.keys(this._custom);\n\t\tthis.origin = null;\n\n\t\tthis.report = function (message) {\n\t\t\tvar newNot = {\n\t\t\t\t\tmessage: message || 'was sanitized',\n\t\t\t\t\tproperty: this.userAlias ? (this.userAlias + ' (' + this._dumpStack() + ')') : this._dumpStack()\n\t\t\t};\n\t\t\tif (!_reporting.some(function (e) { return e.property === newNot.property; })) {\n\t\t\t\t_reporting.push(newNot);\n\t\t\t}\n\t\t};\n\n\t\tthis.result = function (data) {\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\treporting: _reporting,\n\t\t\t\tformat: function () {\n\t\t\t\t\treturn this.reporting.map(function (i) {\n\t\t\t\t\t\treturn 'Property ' + i.property + ' ' + i.message;\n\t\t\t\t\t}).join('\\n');\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}\n\n\t_extend(Sanitization.prototype, _sanitizationAttribut);\n\t_extend(Sanitization.prototype, _asyncSanitizationAttribut);\n\t_extend(Sanitization, new Customisable());\n\n\n\tSanitization.prototype.sanitize = function (post, callback) {\n\t\tthis.origin = post;\n\t\tif (typeof callback === 'function') {\n\t\t\tvar self = this;\n\t\t\treturn this._asyncSanitize(this._schema, post, function (err, data) {\n\t\t\t\tself.origin = null;\n\t\t\t\tcallback(err, self.result(data));\n\t\t\t});\n\t\t}\n\t\tvar data = this._sanitize(this._schema, post);\n\t\tthis.origin = null;\n\t\treturn this.result(data);\n\t};\n\n\tSanitization.prototype._sanitize = function (schema, post) {\n\t\tthis.userAlias = schema.alias || null;\n\t\tthis._basicFields.forEach(function (i) {\n\t\t\tif ((i in schema || i === 'optional') && typeof this[i] === 'function') {\n\t\t\t\tpost = this[i](schema, post);\n\t\t\t}\n\t\t}, this);\n\t\tthis._customFields.forEach(function (i) {\n\t\t\tif (i in schema && typeof this._custom[i] === 'function') {\n\t\t\t\tpost = this._custom[i].call(this, schema, post);\n\t\t\t}\n\t\t}, this);\n\t\treturn post;\n\t};\n\n\tSanitization.prototype._asyncSanitize = function (schema, post, callback) {\n\t\tvar self = this;\n\t\tthis.userAlias = schema.alias || null;\n\n\t\tasync.waterfall([\n\t\t\tfunction (next) {\n\t\t\t\tasync.reduce(self._basicFields, post, function (value, i, next) {\n\t\t\t\t\tasync.nextTick(function () {\n\t\t\t\t\t\tif ((i in schema || i === 'optional') && typeof self[i] === 'function') {\n\t\t\t\t\t\t\tif (self[i].length > 2) {\n\t\t\t\t\t\t\t\treturn self[i](schema, value, next);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvalue = self[i](schema, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnext(null, value);\n\t\t\t\t\t});\n\t\t\t\t}, next);\n\t\t\t},\n\t\t\tfunction (inter, next) {\n\t\t\t\tasync.reduce(self._customFields, inter, function (value, i, next) {\n\t\t\t\t\tasync.nextTick(function () {\n\t\t\t\t\t\tif (i in schema && typeof self._custom[i] === 'function') {\n\t\t\t\t\t\t\tif (self._custom[i].length > 2) {\n\t\t\t\t\t\t\t\treturn self._custom[i].call(self, schema, value, next);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvalue = self._custom[i].call(self, schema, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnext(null, value);\n\t\t\t\t\t});\n\t\t\t\t}, next);\n\t\t\t}\n\t\t], callback);\n\t};\n\n\t// ---------------------------------------------------------------------------\n\n\tvar INT_MIN = -2147483648;\n\tvar INT_MAX = 2147483647;\n\n\tvar _rand = {\n\t\tint: function (min, max) {\n\t\t\treturn min + (0 | Math.random() * (max - min + 1));\n\t\t},\n\t\tfloat: function (min, max) {\n\t\t\treturn (Math.random() * (max - min) + min);\n\t\t},\n\t\tbool: function () {\n\t\t\treturn (Math.random() > 0.5);\n\t\t},\n\t\tchar: function (min, max) {\n\t\t\treturn String.fromCharCode(this.int(min, max));\n\t\t},\n\t\tfromList: function (list) {\n\t\t\treturn list[this.int(0, list.length - 1)];\n\t\t}\n\t};\n\n\tvar _formatSample = {\n\t\t'date-time': function () {\n\t\t\treturn new Date().toISOString();\n\t\t},\n\t\t'date': function () {\n\t\t\treturn new Date().toISOString().replace(/T.*$/, '');\n\t\t},\n\t\t'time': function () {\n\t\t\treturn new Date().toLocaleTimeString({}, { hour12: false });\n\t\t},\n\t\t'color': function (min, max) {\n\t\t\tvar s = '#';\n\t\t\tif (min < 1) {\n\t\t\t\tmin = 1;\n\t\t\t}\n\t\t\tfor (var i = 0, l = _rand.int(min, max); i < l; i++) {\n\t\t\t\ts += _rand.fromList('0123456789abcdefABCDEF');\n\t\t\t}\n\t\t\treturn s;\n\t\t},\n\t\t'numeric': function () {\n\t\t\treturn '' + _rand.int(0, INT_MAX);\n\t\t},\n\t\t'integer': function () {\n\t\t\tif (_rand.bool() === true) {\n\t\t\t\treturn '-' + this.numeric();\n\t\t\t}\n\t\t\treturn this.numeric();\n\t\t},\n\t\t'decimal': function () {\n\t\t\treturn this.integer() + '.' + this.numeric();\n\t\t},\n\t\t'alpha': function (min, max) {\n\t\t\tvar s = '';\n\t\t\tif (min < 1) {\n\t\t\t\tmin = 1;\n\t\t\t}\n\t\t\tfor (var i = 0, l = _rand.int(min, max); i < l; i++) {\n\t\t\t\ts += _rand.fromList('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ');\n\t\t\t}\n\t\t\treturn s;\n\t\t},\n\t\t'alphaNumeric': function (min, max) {\n\t\t\tvar s = '';\n\t\t\tif (min < 1) {\n\t\t\t\tmin = 1;\n\t\t\t}\n\t\t\tfor (var i = 0, l = _rand.int(min, max); i < l; i++) {\n\t\t\t\ts += _rand.fromList('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');\n\t\t\t}\n\t\t\treturn s;\n\t\t},\n\t\t'alphaDash': function (min, max) {\n\t\t\tvar s = '';\n\t\t\tif (min < 1) {\n\t\t\t\tmin = 1;\n\t\t\t}\n\t\t\tfor (var i = 0, l = _rand.int(min, max); i < l; i++) {\n\t\t\t\ts += _rand.fromList('_-abcdefghijklmnopqrstuvwxyz_-ABCDEFGHIJKLMNOPQRSTUVWXYZ_-0123456789_-');\n\t\t\t}\n\t\t\treturn s;\n\t\t},\n\t\t'javascript': function (min, max) {\n\t\t\tvar s = _rand.fromList('_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$');\n\t\t\tfor (var i = 0, l = _rand.int(min, max - 1); i < l; i++) {\n\t\t\t\ts += _rand.fromList('_$abcdefghijklmnopqrstuvwxyz_$ABCDEFGHIJKLMNOPQRSTUVWXYZ_$0123456789_$');\n\t\t\t}\n\t\t\treturn s;\n\t\t}\n\t};\n\n\tfunction _getLimits(schema) {\n\t\tvar min = INT_MIN;\n\t\tvar max = INT_MAX;\n\n\t\tif (schema.gte != null) {\n\t\t\tmin = schema.gte;\n\t\t}\n\t\telse if (schema.gt != null) {\n\t\t\tmin = schema.gt + 1;\n\t\t}\n\t\tif (schema.lte != null) {\n\t\t\tmax = schema.lte;\n\t\t}\n\t\telse if (schema.lt != null) {\n\t\t\tmax = schema.lt - 1;\n\t\t}\n\t\treturn { min: min, max: max };\n\t}\n\n\tvar _typeGenerator = {\n\t\tstring: function (schema) {\n\t\t\tif (schema.eq != null) {\n\t\t\t\treturn schema.eq;\n\t\t\t}\n\t\t\tvar s = '';\n\t\t\tvar minLength = schema.minLength != null ? schema.minLength : 0;\n\t\t\tvar maxLength = schema.maxLength != null ? schema.maxLength : 32;\n\t\t\tif (typeof schema.pattern === 'string' && typeof _formatSample[schema.pattern] === 'function') {\n\t\t\t\treturn _formatSample[schema.pattern](minLength, maxLength);\n\t\t\t}\n\n\t\t\tvar l = schema.exactLength != null ? schema.exactLength : _rand.int(minLength, maxLength);\n\t\t\tfor (var i = 0; i < l; i++) {\n\t\t\t\ts += _rand.char(32, 126);\n\t\t\t}\n\t\t\treturn s;\n\t\t},\n\t\tnumber: function (schema) {\n\t\t\tif (schema.eq != null) {\n\t\t\t\treturn schema.eq;\n\t\t\t}\n\t\t\tvar limit = _getLimits(schema);\n\t\t\tvar n = _rand.float(limit.min, limit.max);\n\t\t\tif (schema.ne != null) {\n\t\t\t\tvar ne = _typeIs.array(schema.ne) ? schema.ne : [schema.ne];\n\t\t\t\twhile (ne.indexOf(n) !== -1) {\n\t\t\t\t\tn = _rand.float(limit.min, limit.max);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn n;\n\t\t},\n\t\tinteger: function (schema) {\n\t\t\tif (schema.eq != null) {\n\t\t\t\treturn schema.eq;\n\t\t\t}\n\t\t\tvar limit = _getLimits(schema);\n\t\t\tvar n = _rand.int(limit.min, limit.max);\n\t\t\tif (schema.ne != null) {\n\t\t\t\tvar ne = _typeIs.array(schema.ne) ? schema.ne : [schema.ne];\n\t\t\t\twhile (ne.indexOf(n) !== -1) {\n\t\t\t\t\tn = _rand.int(limit.min, limit.max);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn n;\n\t\t},\n\t\tboolean: function (schema) {\n\t\t\tif (schema.eq != null) {\n\t\t\t\treturn schema.eq;\n\t\t\t}\n\t\t\treturn _rand.bool();\n\t\t},\n\t\t\"null\": function (schema) {\n\t\t\treturn null;\n\t\t},\n\t\tdate: function (schema) {\n\t\t\tif (schema.eq != null) {\n\t\t\t\treturn schema.eq;\n\t\t\t}\n\t\t\treturn new Date();\n\t\t},\n\t\tobject: function (schema) {\n\t\t\tvar o = {};\n\t\t\tvar prop = schema.properties || {};\n\n\t\t\tfor (var key in prop) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(prop, key)) {\n\t\t\t\t\tif (prop[key].optional === true && _rand.bool() === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (key !== '*') {\n\t\t\t\t\t\to[key] = this.generate(prop[key]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar rk = '__random_key_';\n\t\t\t\t\t\tvar randomKey = rk + 0;\n\t\t\t\t\t\tvar n = _rand.int(1, 9);\n\t\t\t\t\t\tfor (var i = 1; i <= n; i++) {\n\t\t\t\t\t\t\tif (!(randomKey in prop)) {\n\t\t\t\t\t\t\t\to[randomKey] = this.generate(prop[key]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trandomKey = rk + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn o;\n\t\t},\n\t\tarray: function (schema) {\n\t\t\tvar self = this;\n\t\t\tvar items = schema.items || {};\n\t\t\tvar minLength = schema.minLength != null ? schema.minLength : 0;\n\t\t\tvar maxLength = schema.maxLength != null ? schema.maxLength : 16;\n\t\t\tvar type;\n\t\t\tvar candidate;\n\t\t\tvar size;\n\t\t\tvar i;\n\n\t\t\tif (_typeIs.array(items)) {\n\t\t\t\tsize = items.length;\n\t\t\t\tif (schema.exactLength != null) {\n\t\t\t\t\tsize = schema.exactLength;\n\t\t\t\t}\n\t\t\t\telse if (size < minLength) {\n\t\t\t\t\tsize = minLength;\n\t\t\t\t}\n\t\t\t\telse if (size > maxLength) {\n\t\t\t\t\tsize = maxLength;\n\t\t\t\t}\n\t\t\t\tcandidate = new Array(size);\n\t\t\t\ttype = null;\n\t\t\t\tfor (i = 0; i < size; i++) {\n\t\t\t\t\ttype = items[i].type || 'any';\n\t\t\t\t\tif (_typeIs.array(type)) {\n\t\t\t\t\t\ttype = type[_rand.int(0, type.length - 1)];\n\t\t\t\t\t}\n\t\t\t\t\tcandidate[i] = self[type](items[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsize = schema.exactLength != null ? schema.exactLength : _rand.int(minLength, maxLength);\n\t\t\t\tcandidate = new Array(size);\n\t\t\t\ttype = items.type || 'any';\n\t\t\t\tif (_typeIs.array(type)) {\n\t\t\t\t\ttype = type[_rand.int(0, type.length - 1)];\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < size; i++) {\n\t\t\t\t\tcandidate[i] = self[type](items);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn candidate;\n\t\t},\n\t\tany: function (schema) {\n\t\t\tvar fields = Object.keys(_typeGenerator);\n\t\t\tvar i = fields[_rand.int(0, fields.length - 2)];\n\t\t\treturn this[i](schema);\n\t\t}\n\t};\n\n\t// CandidateGenerator Class (Singleton) --------------------------------------\n\tfunction CandidateGenerator() {\n\t\t// Maybe extends Inspection class too ?\n\t}\n\n\t_extend(CandidateGenerator.prototype, _typeGenerator);\n\n\tvar _instance = null;\n\tCandidateGenerator.instance = function () {\n\t\tif (!(_instance instanceof CandidateGenerator)) {\n\t\t\t_instance = new CandidateGenerator();\n\t\t}\n\t\treturn _instance;\n\t};\n\n\tCandidateGenerator.prototype.generate = function (schema) {\n\t\tvar type = schema.type || 'any';\n\t\tif (_typeIs.array(type)) {\n\t\t\ttype = type[_rand.int(0, type.length - 1)];\n\t\t}\n\t\treturn this[type](schema);\n\t};\n\n// Exports ---------------------------------------------------------------------\n\tvar SchemaInspector = {};\n\n\t// if server-side (node.js) else client-side\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = SchemaInspector;\n\t}\n\telse {\n\t\twindow.SchemaInspector = SchemaInspector;\n\t}\n\n\tSchemaInspector.newSanitization = function (schema, custom) {\n\t\treturn new Sanitization(schema, custom);\n\t};\n\n\tSchemaInspector.newValidation = function (schema, custom) {\n\t\treturn new Validation(schema, custom);\n\t};\n\n\tSchemaInspector.Validation = Validation;\n\tSchemaInspector.Sanitization = Sanitization;\n\n\tSchemaInspector.sanitize = function (schema, post, custom, callback) {\n\t\tif (arguments.length === 3 && typeof custom === 'function') {\n\t\t\tcallback = custom;\n\t\t\tcustom = null;\n\t\t}\n\t\treturn new Sanitization(schema, custom).sanitize(post, callback);\n\t};\n\n\tSchemaInspector.validate = function (schema, candidate, custom, callback) {\n\t\tif (arguments.length === 3 && typeof custom === 'function') {\n\t\t\tcallback = custom;\n\t\t\tcustom = null;\n\t\t}\n\t\treturn new Validation(schema, custom).validate(candidate, callback);\n\t};\n\n\tSchemaInspector.generate = function (schema, n) {\n\t\tif (typeof n === 'number') {\n\t\t\tvar r = new Array(n);\n\t\t\tfor (var i = 0; i < n; i++) {\n\t\t\t\tr[i] = CandidateGenerator.instance().generate(schema);\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\t\treturn CandidateGenerator.instance().generate(schema);\n\t};\n})();\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}